"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkshopify_base_2_0"] = self["webpackChunkshopify_base_2_0"] || []).push([["section-bf"],{

/***/ "./src/modules/bf/bf.js":
/*!******************************!*\
  !*** ./src/modules/bf/bf.js ***!
  \******************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _bf_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./bf.css */ \"./src/modules/bf/bf.css\");\n/* eslint-disable */\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  //Select parent section\n  const parentSection = document.querySelectorAll('.section-explore');\n  parentSection.forEach(section => {\n    // Product cards hover logic\n    const productCards = section.querySelectorAll('.section-explore__product');\n    const desktopLabel = section.querySelector('.section-explore__collection-label-desktop');\n    const travelLabel = section.querySelector('.section-explore__collection-label-travel');\n    let activeProduct = null;\n    let activeCard = null;\n    const initialProduct = section.querySelector('.section-explore__product-content [data-product=\"for-desktop-1\"]');\n    if (initialProduct) {\n      initialProduct.style.opacity = '1';\n      initialProduct.style.transition = 'opacity 0.5s ease';\n      if (desktopLabel) {\n        desktopLabel.classList.add('active');\n      }\n      const initialLines = initialProduct.querySelectorAll('.animate-line');\n      initialLines.forEach(line => line.classList.add('active-line'));\n      activeProduct = initialProduct;\n      const firstCard = section.querySelector('.section-explore__product[data-product-hover=\"for-desktop-1\"]');\n      if (firstCard) {\n        firstCard.classList.add('active');\n        activeCard = firstCard;\n      }\n    }\n    productCards.forEach(card => {\n      card.addEventListener('mouseenter', () => {\n        const productIndex = card.getAttribute('data-product-hover');\n        if (productIndex.startsWith('for-desktop')) {\n          if (desktopLabel) desktopLabel.classList.add('active');\n          if (travelLabel) travelLabel.classList.remove('active');\n        } else if (productIndex.startsWith('for-travel')) {\n          if (travelLabel) travelLabel.classList.add('active');\n          if (desktopLabel) desktopLabel.classList.remove('active');\n        }\n        if (activeProduct) {\n          activeProduct.style.opacity = '0';\n          const activeLines = activeProduct.querySelectorAll('.animate-line');\n          activeLines.forEach(line => line.classList.remove('active-line'));\n        }\n        const targetContent = section.querySelector(`.section-explore__product-content [data-product=\"${productIndex}\"]`);\n        if (targetContent) {\n          targetContent.style.opacity = '1';\n          targetContent.style.transition = 'opacity 0.5s ease';\n          const targetLines = targetContent.querySelectorAll('.animate-line');\n          targetLines.forEach(line => line.classList.add('active-line'));\n          activeProduct = targetContent;\n        }\n        if (activeCard) {\n          activeCard.classList.remove('active');\n        }\n        card.classList.add('active');\n        activeCard = card;\n      });\n    });\n\n    // Popup toggle logic\n    const buyNowButtons = section.querySelectorAll('.js-section-explore__buy-now');\n    const popups = section.querySelectorAll('.buy-now-popup');\n    function openPopup(popup) {\n      popup.style.display = 'block';\n      popup.classList.add('active');\n      document.querySelector('body').style.overflow = 'hidden';\n    }\n    function closePopup(popup) {\n      popup.style.display = 'none';\n      popup.classList.remove('active');\n      document.querySelector('body').style.overflow = 'auto';\n    }\n\n    // Function to update the state of the minus button based on quantity\n    function updateQuantityButtonsState(input, minusButton) {\n      const quantity = parseInt(input.value);\n      if (quantity <= 1) {\n        minusButton.setAttribute(\"disabled\", true);\n        minusButton.classList.add('disabled');\n      } else {\n        minusButton.removeAttribute(\"disabled\");\n        minusButton.classList.remove('disabled');\n      }\n    }\n\n    // Reset quantity button event listeners\n    function resetQuantityListeners() {\n      const quantityMinusButtons = section.querySelectorAll('.buy-now-popup__quantity button[name=\"minus\"]');\n      const quantityPlusButtons = section.querySelectorAll('.buy-now-popup__quantity button[name=\"plus\"]');\n      quantityMinusButtons.forEach(button => {\n        const newButton = button.cloneNode(true);\n        button.parentNode.replaceChild(newButton, button);\n      });\n      quantityPlusButtons.forEach(button => {\n        const newButton = button.cloneNode(true);\n        button.parentNode.replaceChild(newButton, button);\n      });\n    }\n\n    // Handling Buy Now button clicks\n    buyNowButtons.forEach((button, index) => {\n      button.addEventListener('click', () => {\n        const popup = button.parentNode.querySelector('.buy-now-popup');\n        console.log(popup, 'popup');\n        if (popup) {\n          openPopup(popup);\n          resetQuantityListeners();\n\n          // Add quantity control logic\n          const quantityInputs = popup.querySelectorAll('.buy-now-popup__quantity input[type=\"number\"]');\n          const quantityMinusButtons = popup.querySelectorAll('.buy-now-popup__quantity button[name=\"minus\"]');\n          const quantityPlusButtons = popup.querySelectorAll('.buy-now-popup__quantity button[name=\"plus\"]');\n          quantityInputs.forEach((input, idx) => {\n            const minusButton = quantityMinusButtons[idx];\n            const plusButton = quantityPlusButtons[idx];\n\n            // Initially check if the minus button should be disabled\n            updateQuantityButtonsState(input, minusButton);\n            minusButton.addEventListener('click', () => {\n              let quantity = parseInt(input.value);\n              if (quantity > 1) {\n                input.value = quantity - 1;\n                const addToCartButton = popup.querySelector('.js-atc-bf');\n                const addToCheckoutButton = popup.querySelector('.js-checkout');\n                addToCartButton.setAttribute(\"data-quantity\", input.value);\n                addToCheckoutButton.setAttribute(\"data-quantity\", input.value);\n              }\n              updateQuantityButtonsState(input, minusButton); // Update button state after quantity change\n            });\n\n            plusButton.addEventListener('click', () => {\n              let quantity = parseInt(input.value);\n              input.value = quantity + 1;\n              const addToCartButton = popup.querySelector('.js-atc-bf');\n              const addToCheckoutButton = popup.querySelector('.js-checkout');\n              addToCartButton.setAttribute(\"data-quantity\", input.value);\n              addToCheckoutButton.setAttribute(\"data-quantity\", input.value);\n              updateQuantityButtonsState(input, minusButton); // Update button state after quantity change\n            });\n          });\n\n          // Expand description logic\n          const learnMoreButton = popup.querySelector('.buy-now-popup__expand-desc');\n          const descriptionEl = popup.querySelector('.buy-now-popup__description');\n          const descriptionInner = popup.querySelector('.buy-now-popup__description-inner');\n          if (learnMoreButton) {\n            const clonedLearnMoreButton = learnMoreButton.cloneNode(true);\n            learnMoreButton.parentNode.replaceChild(clonedLearnMoreButton, learnMoreButton);\n            clonedLearnMoreButton.addEventListener('click', () => {\n              const expanded = descriptionEl.classList.contains('expanded');\n              if (expanded) {\n                descriptionEl.classList.remove('expanded');\n                descriptionInner.style.height = '100px';\n                clonedLearnMoreButton.querySelector('span').textContent = 'Learn More';\n                descriptionInner.classList.add('with-gradient');\n              } else {\n                descriptionEl.classList.add('expanded');\n                descriptionInner.style.height = `${descriptionInner.scrollHeight}px`;\n                clonedLearnMoreButton.querySelector('span').textContent = 'Show Less';\n                descriptionInner.classList.remove('with-gradient');\n              }\n            });\n          }\n\n          // Upsell checkbox toggle logic\n          const upsellBoxes = popup.querySelectorAll('.buy-now-popup__upsell-box');\n          upsellBoxes.forEach(box => {\n            const checkbox = box.querySelector('input[type=\"checkbox\"]');\n            box.addEventListener('click', () => {\n              checkbox.checked = !checkbox.checked;\n              if (checkbox.checked) {\n                box.classList.add('active');\n              } else {\n                box.classList.remove('active');\n              }\n            });\n          });\n        }\n      });\n    });\n\n    // Add click event listener to close icons\n    popups.forEach(popup => {\n      const closeButtons = popup.querySelectorAll('.close-buy-now-popup');\n      closeButtons.forEach(button => {\n        button.addEventListener('click', () => {\n          closePopup(popup);\n        });\n      });\n    });\n    function updatePlaceholders() {\n      console.log('updating placeholders');\n      fetch('/cart.js').then(response => {\n        if (!response.ok) {\n          throw new Error(`HTTP error! Status: ${response.status}`);\n        }\n        return response.json();\n      }).then(cart => {\n        // Example: Display cart items in a div\n        console.log(cart, 'cart');\n        document.querySelector('body').style.overflow = 'auto';\n        const output = document.querySelector('.js-output');\n        const item_count = cart.item_count;\n        const placeholders = document.querySelectorAll('.placeholder');\n        const cartItems = cart.items;\n        placeholders.forEach(placeholder => {\n          placeholder.classList.remove('filled');\n          placeholder.innerHTML = '+';\n        });\n        const giftSelectorsActive = document.querySelectorAll(`.gift_card[data-gift]`);\n        const cartTotal = cart.total_price;\n        console.log(giftSelectorsActive, cartTotal, 'giftSelectorsActive');\n        // if(giftSelectorsActive) {\n        //     giftSelectorsActive.forEach(gift => {\n        //         gift.classList.remove('is-active')\n        //         gift.querySelector('.gift-overlay').classList.remove('is-active')\n        //         gift.querySelector('.top-note').classList.remove('is-active')\n        //         if(gift.querySelector('.conf')) {\n        //             gift.querySelector('.conf').classList.remove('is-active')\n        //         }\n        //         let giftNumber = gift.getAttribute('data-money')\n        //         if (cartTotal >= giftNumber) {\n        //             gift.classList.add('is-active')\n        //             gift.querySelector('.gift-overlay').classList.add('is-active')\n        //             gift.querySelector('.top-note').classList.add('is-active')\n        //             if(gift.querySelector('.conf')) {\n        //                 gift.querySelector('.conf').classList.add('is-active')\n        //             }\n        //         }\n        //     })\n        // }\n        // Fill placeholders with cart items\n        cartItems.forEach((item, index) => {\n          console.log(item, index, placeholders.length, 'item, index');\n          if (index < placeholders.length) {\n            placeholders[index].innerHTML = `\n                                <img src=\"${item.image}\" alt=\"${item.title}\" class=\"w-full h-full object-cover\">\n                                <div class=\"absolute bg-black flex items-center justify-center w-[30%] h-[30%] bottom-[5px] right-[5px]\">\n                                    <p class=\"text-white text-center\">${item.quantity}</p>\n                                </div>\n                                <div data-id=\"${item.id}\" class=\"absolute bg-[#c14444] flex items-center justify-center w-[16px] h-[16px] top-[-8px] right-[-8px] js-remove-product cursor-pointer color-white rounded-[50%]\">\n                                    x\n                                </div>\n                            `;\n          } else {\n            document.querySelector('.js-output').innerHTML += `\n                            <div class=\"sticky-card-product w-[50px] h-[50px] bg-white flex items-center justify-center placeholder relative\">\n                                <img src=\"${item.image}\" alt=\"${item.title}\" class=\"w-full h-full object-cover\">\n                                <div class=\"absolute bg-black flex items-center justify-center w-[30%] h-[30%] bottom-[5px] right-[5px]\">\n                                    <p class=\"text-white text-center\">${item.quantity}</p>\n                                </div>\n                                <div data-id=\"${item.id}\" class=\"absolute bg-[#c14444] flex items-center justify-center w-[16px] h-[16px] top-[-8px] right-[-8px] js-remove-product cursor-pointer color-white rounded-[50%]\">\n                                    x\n                                </div>\n                            </div>\n                            `;\n          }\n        });\n      }).catch(error => {\n        console.error('Error fetching cart:', error);\n      });\n      console.log('done updating placeholders');\n    }\n    function initializeTrackingBar() {\n      const messageContainer = document.querySelector('[data-tracking-bar-message]');\n      const progressBar = document.querySelector('[data-progress-bar]');\n      const blocks = Array.from(document.querySelectorAll('[data-tracking-bar-blocks] li')).map(block => ({\n        itemCount: parseInt(block.getAttribute('data-item-count'), 10),\n        percentageOff: parseInt(block.getAttribute('data-percentage-off'), 10)\n      }));\n      let cartItemCount = 0;\n      console.log(blocks, 'blocks');\n      function updateTrackingBar() {\n        let currentBlock = null;\n        let nextBlock = null;\n\n        // Determine the current and next discount blocks\n        for (let i = 0; i < blocks.length; i++) {\n          if (cartItemCount >= blocks[i].itemCount) {\n            currentBlock = blocks[i];\n          } else {\n            nextBlock = blocks[i];\n            break;\n          }\n        }\n\n        // Update message and progress bar\n        if (!currentBlock) {\n          // Before the first block\n          const itemsLeft = blocks[0].itemCount - cartItemCount;\n          messageContainer.textContent = `Add ${itemsLeft} more items to save ${blocks[0].percentageOff}%.`;\n          // const progress = (cartItemCount / blocks[0].itemCount) * 100;\n          // progressBar.style.width = `${progress}%`;\n        } else if (!nextBlock) {\n          // Maximum discount reached\n          messageContainer.textContent = `You are at your maximum discount of ${currentBlock.percentageOff}%.`;\n          // progressBar.style.width = '100%';\n        } else {\n          // Between blocks\n          const itemsLeft = nextBlock.itemCount - cartItemCount;\n          messageContainer.textContent = `You get ${currentBlock.percentageOff}% off. Add ${itemsLeft} more items to get ${nextBlock.percentageOff}% off.`;\n          const progress = (cartItemCount - currentBlock.itemCount) / (nextBlock.itemCount - currentBlock.itemCount) * 100;\n          // progressBar.style.width = `${progress}%`;\n        }\n\n        const maxItems = blocks[blocks.length - 1].itemCount;\n        const progress = Math.min(cartItemCount / maxItems * 100, 100); // Cap at 100%\n        progressBar.style.width = `${progress}%`;\n      }\n      function fetchCartCount() {\n        fetch('/cart.js').then(response => response.json()).then(cart => {\n          cartItemCount = cart.item_count;\n          updateTrackingBar();\n        }).catch(error => console.error('Error fetching cart data:', error));\n      }\n\n      // Initial setup\n      fetchCartCount();\n    }\n    function getCartItemCount() {\n      fetch('/cart.js').then(response => response.json()).then(cart => {\n        const itemCount = cart.item_count; // Total number of items in the cart\n        console.log('Cart item count:', itemCount);\n\n        // Use this value to update your tracking bar or any other UI elements\n        initializeTrackingBar(itemCount); // Example: Hook into your tracking bar logic\n      }).catch(error => {\n        console.error('Error fetching cart data:', error);\n      });\n    }\n    window.addEventListener('load', getCartItemCount);\n    window.addEventListener('load', updatePlaceholders);\n    function removeProduct(productId) {\n      console.log('removing product', productId);\n      fetch(window.Shopify.routes.root + 'cart/change.js', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          id: productId,\n          quantity: 0\n        })\n      }).then(response => {\n        if (response.status === 200) {\n          updatePlaceholders();\n          getCartItemCount();\n        }\n        return response.json();\n      }).catch(error => {\n        console.error('Error:', error);\n      });\n    }\n    let removeProductButtons = document.querySelectorAll('.js-remove-product');\n    document.addEventListener('click', function (event) {\n      if (event.target && event.target.matches('.js-remove-product')) {\n        var dataId = event.target.getAttribute('data-id'); // Retrieve the data-id attribute\n        removeProduct(dataId);\n      }\n    });\n    // console.log(removeProductButtons, 'removeProductButtons');\n    // removeProductButtons.forEach(button => {\n    //     button.addEventListener('click', () => {\n    //         const productId = button.getAttribute('data-id');\n    //         removeProduct(productId);\n    //     });\n    // });\n\n    // Add to cart logic\n    let addToCarts = section.querySelectorAll(\".js-atc-bf\"); // Select all add to cart buttons\n    console.log('da li smo ovdeee');\n    addToCarts.forEach(addToCart => {\n      addToCart.addEventListener(\"click\", e => {\n        console.log('clicked');\n        document.querySelector('body').style.overflow = 'auto';\n        let checkout = false;\n        if (addToCart.classList.contains('js-checkout')) {\n          // Check if the button is checkout\n          checkout = true;\n        }\n        let _this = e.target;\n        let productId = _this.getAttribute(\"data-product-id\"); // Get the product id\n        let quantity = _this.getAttribute(\"data-quantity\"); // Get the quantity\n        const upsellProductSelectors = section.querySelectorAll(\".js-upsell-selector.active\"); // Get all active upsell products\n        const addItems = []; // Create an array for items\n        addItems.push({\n          // Add the main product to the array\n          id: productId,\n          quantity: quantity\n        });\n        upsellProductSelectors.forEach(upsellProductSelector => {\n          // Add upsell products to the array\n          const productId = upsellProductSelector.getAttribute(\"data-product-id\");\n          addItems.push({\n            id: productId,\n            quantity: 1\n          });\n        });\n        console.log(addItems, 'addItems');\n        const formData = {\n          // Form data for the cart\n          items: addItems\n        };\n        fetch(window.Shopify.routes.root + \"cart/add.js\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify(formData)\n        }).then(response => {\n          console.log(response.status, \"ok\"); // Check if the response is OK\n          if (response.status === 200) {\n            document.querySelector('.buy-now-popup.active').style.display = 'none';\n            document.querySelector('.buy-now-popup.active').classList.remove('active');\n            document.querySelector('body').style.overflow = 'auto';\n            updatePlaceholders();\n            getCartItemCount();\n          }\n          if (response.status === 200 && checkout) {\n            window.location.href = '/checkout';\n          }\n          return response.json();\n        }).catch(error => {\n          console.error(\"Error:\", error);\n        });\n      });\n    });\n  });\n});\nlet gridImages = document.querySelectorAll('.js-grid-image');\nconsole.log(gridImages, 'gridImages');\ngridImages.forEach(gridImage => {\n  gridImage.addEventListener('click', e => {\n    let _this = gridImage;\n    let imageQty = _this.getAttribute('data-image-qty');\n    let ttquantity = gridImage.parentNode.parentNode.querySelector('.quantity__input');\n    let buyMore = gridImage.parentNode.parentNode.querySelector('.js-buy-more');\n    let atc = gridImage.parentNode.parentNode.parentNode.parentNode.querySelector('.js-atc-bf');\n    atc.setAttribute('data-quantity', imageQty);\n    gridImage.parentNode.parentNode.querySelector('.quantity__button').classList.remove('disabled');\n    ttquantity.value = imageQty;\n    if (imageQty < 1 && buyMore) {\n      imageQty = 1;\n    }\n    if (imageQty < 4 && buyMore) {\n      buyMore.textContent = 'Add 4 save 55%%';\n      buyMore.setAttribute('data-count', 4);\n      buyMore.classList.remove('hidden');\n    }\n    if (imageQty >= 4 && imageQty < 6 && buyMore) {\n      buyMore.textContent = 'Add 6 save 65%';\n      buyMore.setAttribute('data-count', 6);\n      buyMore.classList.remove('hidden');\n    }\n    if (imageQty >= 6 && buyMore) {\n      buyMore.textContent = 'Add 10 save 80%';\n      buyMore.setAttribute('data-count', 10);\n      buyMore.classList.remove('hidden');\n    }\n    if (imageQty < 10 && buyMore) {\n      buyMore.classList.remove('hidden');\n    }\n    if (imageQty >= 10 && buyMore) {\n      buyMore.classList.add('hidden');\n    }\n  });\n});\nfunction initializeStickyTrackingBar() {\n  const trackingBar = document.querySelector('[data-tracking-bar]');\n  const stickyClass = 'sticky-bar';\n  function handleStickyBehavior() {\n    const scrollPosition = window.scrollY; // Current vertical scroll position\n    const viewportHeight = window.innerHeight; // Viewport height\n\n    if (scrollPosition > 40 || viewportHeight < 40) {\n      trackingBar.classList.add(stickyClass);\n    } else {\n      trackingBar.classList.remove(stickyClass);\n    }\n  }\n\n  // Attach scroll and resize event listeners\n  window.addEventListener('scroll', handleStickyBehavior);\n  window.addEventListener('resize', handleStickyBehavior);\n\n  // Initial check\n  handleStickyBehavior();\n}\ninitializeStickyTrackingBar();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbW9kdWxlcy9iZi9iZi5qcyIsIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUVBOztBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2hvcGlmeS1iYXNlLTIuMC8uL3NyYy9tb2R1bGVzL2JmL2JmLmpzP2JlNzQiXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgKi9cbmltcG9ydCAnLi9iZi5jc3MnXG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgLy9TZWxlY3QgcGFyZW50IHNlY3Rpb25cbiAgICBjb25zdCBwYXJlbnRTZWN0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlY3Rpb24tZXhwbG9yZScpO1xuICAgIHBhcmVudFNlY3Rpb24uZm9yRWFjaChzZWN0aW9uID0+IHtcbiAgICAgICAgLy8gUHJvZHVjdCBjYXJkcyBob3ZlciBsb2dpY1xuICAgICAgICBjb25zdCBwcm9kdWN0Q2FyZHMgPSBzZWN0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWN0aW9uLWV4cGxvcmVfX3Byb2R1Y3QnKTtcbiAgICAgICAgY29uc3QgZGVza3RvcExhYmVsID0gc2VjdGlvbi5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi1leHBsb3JlX19jb2xsZWN0aW9uLWxhYmVsLWRlc2t0b3AnKTtcbiAgICAgICAgY29uc3QgdHJhdmVsTGFiZWwgPSBzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLWV4cGxvcmVfX2NvbGxlY3Rpb24tbGFiZWwtdHJhdmVsJyk7XG5cbiAgICAgICAgbGV0IGFjdGl2ZVByb2R1Y3QgPSBudWxsO1xuICAgICAgICBsZXQgYWN0aXZlQ2FyZCA9IG51bGw7XG5cbiAgICAgICAgY29uc3QgaW5pdGlhbFByb2R1Y3QgPSBzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLWV4cGxvcmVfX3Byb2R1Y3QtY29udGVudCBbZGF0YS1wcm9kdWN0PVwiZm9yLWRlc2t0b3AtMVwiXScpO1xuICAgICAgICBpZiAoaW5pdGlhbFByb2R1Y3QpIHtcbiAgICAgICAgICAgIGluaXRpYWxQcm9kdWN0LnN0eWxlLm9wYWNpdHkgPSAnMSc7XG4gICAgICAgICAgICBpbml0aWFsUHJvZHVjdC5zdHlsZS50cmFuc2l0aW9uID0gJ29wYWNpdHkgMC41cyBlYXNlJztcbiAgICAgICAgICAgIGlmKGRlc2t0b3BMYWJlbCkge1xuICAgICAgICAgICAgICAgIGRlc2t0b3BMYWJlbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGluaXRpYWxMaW5lcyA9IGluaXRpYWxQcm9kdWN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hbmltYXRlLWxpbmUnKTtcbiAgICAgICAgICAgIGluaXRpYWxMaW5lcy5mb3JFYWNoKGxpbmUgPT4gbGluZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUtbGluZScpKTtcbiAgICAgICAgICAgIGFjdGl2ZVByb2R1Y3QgPSBpbml0aWFsUHJvZHVjdDtcblxuICAgICAgICAgICAgY29uc3QgZmlyc3RDYXJkID0gc2VjdGlvbi5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi1leHBsb3JlX19wcm9kdWN0W2RhdGEtcHJvZHVjdC1ob3Zlcj1cImZvci1kZXNrdG9wLTFcIl0nKTtcbiAgICAgICAgICAgIGlmIChmaXJzdENhcmQpIHtcbiAgICAgICAgICAgICAgICBmaXJzdENhcmQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgYWN0aXZlQ2FyZCA9IGZpcnN0Q2FyZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHByb2R1Y3RDYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG4gICAgICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvZHVjdEluZGV4ID0gY2FyZC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvZHVjdC1ob3ZlcicpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHByb2R1Y3RJbmRleC5zdGFydHNXaXRoKCdmb3ItZGVza3RvcCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKGRlc2t0b3BMYWJlbCkgZGVza3RvcExhYmVsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodHJhdmVsTGFiZWwpIHRyYXZlbExhYmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocHJvZHVjdEluZGV4LnN0YXJ0c1dpdGgoJ2Zvci10cmF2ZWwnKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHJhdmVsTGFiZWwpIHRyYXZlbExhYmVsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICAgICBpZihkZXNrdG9wTGFiZWwpIGRlc2t0b3BMYWJlbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlUHJvZHVjdCkge1xuICAgICAgICAgICAgICAgICAgICBhY3RpdmVQcm9kdWN0LnN0eWxlLm9wYWNpdHkgPSAnMCc7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUxpbmVzID0gYWN0aXZlUHJvZHVjdC5xdWVyeVNlbGVjdG9yQWxsKCcuYW5pbWF0ZS1saW5lJyk7XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmVzLmZvckVhY2gobGluZSA9PiBsaW5lLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZS1saW5lJykpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldENvbnRlbnQgPSBzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoYC5zZWN0aW9uLWV4cGxvcmVfX3Byb2R1Y3QtY29udGVudCBbZGF0YS1wcm9kdWN0PVwiJHtwcm9kdWN0SW5kZXh9XCJdYCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0Q29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRDb250ZW50LnN0eWxlLm9wYWNpdHkgPSAnMSc7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldENvbnRlbnQuc3R5bGUudHJhbnNpdGlvbiA9ICdvcGFjaXR5IDAuNXMgZWFzZSc7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldExpbmVzID0gdGFyZ2V0Q29udGVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYW5pbWF0ZS1saW5lJyk7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldExpbmVzLmZvckVhY2gobGluZSA9PiBsaW5lLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZS1saW5lJykpO1xuICAgICAgICAgICAgICAgICAgICBhY3RpdmVQcm9kdWN0ID0gdGFyZ2V0Q29udGVudDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlQ2FyZCkge1xuICAgICAgICAgICAgICAgICAgICBhY3RpdmVDYXJkLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNhcmQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgYWN0aXZlQ2FyZCA9IGNhcmQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gUG9wdXAgdG9nZ2xlIGxvZ2ljXG4gICAgICAgIGNvbnN0IGJ1eU5vd0J1dHRvbnMgPSBzZWN0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1zZWN0aW9uLWV4cGxvcmVfX2J1eS1ub3cnKTtcbiAgICAgICAgY29uc3QgcG9wdXBzID0gc2VjdGlvbi5xdWVyeVNlbGVjdG9yQWxsKCcuYnV5LW5vdy1wb3B1cCcpO1xuXG4gICAgICAgIGZ1bmN0aW9uIG9wZW5Qb3B1cChwb3B1cCkge1xuICAgICAgICAgICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2xvc2VQb3B1cChwb3B1cCkge1xuICAgICAgICAgICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLnN0eWxlLm92ZXJmbG93ID0gJ2F1dG8nO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRnVuY3Rpb24gdG8gdXBkYXRlIHRoZSBzdGF0ZSBvZiB0aGUgbWludXMgYnV0dG9uIGJhc2VkIG9uIHF1YW50aXR5XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVF1YW50aXR5QnV0dG9uc1N0YXRlKGlucHV0LCBtaW51c0J1dHRvbikge1xuICAgICAgICAgICAgY29uc3QgcXVhbnRpdHkgPSBwYXJzZUludChpbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICBpZiAocXVhbnRpdHkgPD0gMSkge1xuICAgICAgICAgICAgICAgIG1pbnVzQnV0dG9uLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgIG1pbnVzQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1pbnVzQnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xuICAgICAgICAgICAgICAgIG1pbnVzQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZXNldCBxdWFudGl0eSBidXR0b24gZXZlbnQgbGlzdGVuZXJzXG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0UXVhbnRpdHlMaXN0ZW5lcnMoKSB7XG4gICAgICAgICAgICBjb25zdCBxdWFudGl0eU1pbnVzQnV0dG9ucyA9IHNlY3Rpb24ucXVlcnlTZWxlY3RvckFsbCgnLmJ1eS1ub3ctcG9wdXBfX3F1YW50aXR5IGJ1dHRvbltuYW1lPVwibWludXNcIl0nKTtcbiAgICAgICAgICAgIGNvbnN0IHF1YW50aXR5UGx1c0J1dHRvbnMgPSBzZWN0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoJy5idXktbm93LXBvcHVwX19xdWFudGl0eSBidXR0b25bbmFtZT1cInBsdXNcIl0nKTtcblxuICAgICAgICAgICAgcXVhbnRpdHlNaW51c0J1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3QnV0dG9uID0gYnV0dG9uLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgICAgICAgICBidXR0b24ucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3QnV0dG9uLCBidXR0b24pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHF1YW50aXR5UGx1c0J1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3QnV0dG9uID0gYnV0dG9uLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgICAgICAgICBidXR0b24ucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3QnV0dG9uLCBidXR0b24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBIYW5kbGluZyBCdXkgTm93IGJ1dHRvbiBjbGlja3NcbiAgICAgICAgYnV5Tm93QnV0dG9ucy5mb3JFYWNoKChidXR0b24sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcG9wdXAgPSBidXR0b24ucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnV5LW5vdy1wb3B1cCcpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHBvcHVwLCAncG9wdXAnKTtcbiAgICAgICAgICAgICAgICBpZiAocG9wdXApIHtcbiAgICAgICAgICAgICAgICAgICAgb3BlblBvcHVwKHBvcHVwKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzZXRRdWFudGl0eUxpc3RlbmVycygpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBxdWFudGl0eSBjb250cm9sIGxvZ2ljXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHF1YW50aXR5SW5wdXRzID0gcG9wdXAucXVlcnlTZWxlY3RvckFsbCgnLmJ1eS1ub3ctcG9wdXBfX3F1YW50aXR5IGlucHV0W3R5cGU9XCJudW1iZXJcIl0nKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcXVhbnRpdHlNaW51c0J1dHRvbnMgPSBwb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcuYnV5LW5vdy1wb3B1cF9fcXVhbnRpdHkgYnV0dG9uW25hbWU9XCJtaW51c1wiXScpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBxdWFudGl0eVBsdXNCdXR0b25zID0gcG9wdXAucXVlcnlTZWxlY3RvckFsbCgnLmJ1eS1ub3ctcG9wdXBfX3F1YW50aXR5IGJ1dHRvbltuYW1lPVwicGx1c1wiXScpO1xuXG4gICAgICAgICAgICAgICAgICAgIHF1YW50aXR5SW5wdXRzLmZvckVhY2goKGlucHV0LCBpZHgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbnVzQnV0dG9uID0gcXVhbnRpdHlNaW51c0J1dHRvbnNbaWR4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBsdXNCdXR0b24gPSBxdWFudGl0eVBsdXNCdXR0b25zW2lkeF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluaXRpYWxseSBjaGVjayBpZiB0aGUgbWludXMgYnV0dG9uIHNob3VsZCBiZSBkaXNhYmxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlUXVhbnRpdHlCdXR0b25zU3RhdGUoaW5wdXQsIG1pbnVzQnV0dG9uKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbWludXNCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHF1YW50aXR5ID0gcGFyc2VJbnQoaW5wdXQudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWFudGl0eSA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWUgPSBxdWFudGl0eSAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFkZFRvQ2FydEJ1dHRvbiA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5qcy1hdGMtYmYnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYWRkVG9DaGVja291dEJ1dHRvbiA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5qcy1jaGVja291dCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRUb0NhcnRCdXR0b24uc2V0QXR0cmlidXRlKFwiZGF0YS1xdWFudGl0eVwiLCBpbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFRvQ2hlY2tvdXRCdXR0b24uc2V0QXR0cmlidXRlKFwiZGF0YS1xdWFudGl0eVwiLCBpbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVF1YW50aXR5QnV0dG9uc1N0YXRlKGlucHV0LCBtaW51c0J1dHRvbik7IC8vIFVwZGF0ZSBidXR0b24gc3RhdGUgYWZ0ZXIgcXVhbnRpdHkgY2hhbmdlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcGx1c0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcXVhbnRpdHkgPSBwYXJzZUludChpbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWUgPSBxdWFudGl0eSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYWRkVG9DYXJ0QnV0dG9uID0gcG9wdXAucXVlcnlTZWxlY3RvcignLmpzLWF0Yy1iZicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFkZFRvQ2hlY2tvdXRCdXR0b24gPSBwb3B1cC5xdWVyeVNlbGVjdG9yKCcuanMtY2hlY2tvdXQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRUb0NhcnRCdXR0b24uc2V0QXR0cmlidXRlKFwiZGF0YS1xdWFudGl0eVwiLCBpbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVG9DaGVja291dEJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkYXRhLXF1YW50aXR5XCIsIGlucHV0LnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVRdWFudGl0eUJ1dHRvbnNTdGF0ZShpbnB1dCwgbWludXNCdXR0b24pOyAvLyBVcGRhdGUgYnV0dG9uIHN0YXRlIGFmdGVyIHF1YW50aXR5IGNoYW5nZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEV4cGFuZCBkZXNjcmlwdGlvbiBsb2dpY1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsZWFybk1vcmVCdXR0b24gPSBwb3B1cC5xdWVyeVNlbGVjdG9yKCcuYnV5LW5vdy1wb3B1cF9fZXhwYW5kLWRlc2MnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb25FbCA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5idXktbm93LXBvcHVwX19kZXNjcmlwdGlvbicpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbklubmVyID0gcG9wdXAucXVlcnlTZWxlY3RvcignLmJ1eS1ub3ctcG9wdXBfX2Rlc2NyaXB0aW9uLWlubmVyJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGxlYXJuTW9yZUJ1dHRvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xvbmVkTGVhcm5Nb3JlQnV0dG9uID0gbGVhcm5Nb3JlQnV0dG9uLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlYXJuTW9yZUJ1dHRvbi5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChjbG9uZWRMZWFybk1vcmVCdXR0b24sIGxlYXJuTW9yZUJ1dHRvbik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsb25lZExlYXJuTW9yZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleHBhbmRlZCA9IGRlc2NyaXB0aW9uRWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdleHBhbmRlZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4cGFuZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uRWwuY2xhc3NMaXN0LnJlbW92ZSgnZXhwYW5kZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb25Jbm5lci5zdHlsZS5oZWlnaHQgPSAnMTAwcHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9uZWRMZWFybk1vcmVCdXR0b24ucXVlcnlTZWxlY3Rvcignc3BhbicpLnRleHRDb250ZW50ID0gJ0xlYXJuIE1vcmUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbklubmVyLmNsYXNzTGlzdC5hZGQoJ3dpdGgtZ3JhZGllbnQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbkVsLmNsYXNzTGlzdC5hZGQoJ2V4cGFuZGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uSW5uZXIuc3R5bGUuaGVpZ2h0ID0gYCR7ZGVzY3JpcHRpb25Jbm5lci5zY3JvbGxIZWlnaHR9cHhgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9uZWRMZWFybk1vcmVCdXR0b24ucXVlcnlTZWxlY3Rvcignc3BhbicpLnRleHRDb250ZW50ID0gJ1Nob3cgTGVzcyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uSW5uZXIuY2xhc3NMaXN0LnJlbW92ZSgnd2l0aC1ncmFkaWVudCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVXBzZWxsIGNoZWNrYm94IHRvZ2dsZSBsb2dpY1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cHNlbGxCb3hlcyA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoJy5idXktbm93LXBvcHVwX191cHNlbGwtYm94Jyk7XG4gICAgICAgICAgICAgICAgICAgIHVwc2VsbEJveGVzLmZvckVhY2goKGJveCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hlY2tib3ggPSBib3gucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2JveC5jaGVja2VkID0gIWNoZWNrYm94LmNoZWNrZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrYm94LmNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm94LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJveC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFkZCBjbGljayBldmVudCBsaXN0ZW5lciB0byBjbG9zZSBpY29uc1xuICAgICAgICBwb3B1cHMuZm9yRWFjaCgocG9wdXApID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNsb3NlQnV0dG9ucyA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jbG9zZS1idXktbm93LXBvcHVwJyk7XG4gICAgICAgICAgICBjbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjbG9zZVBvcHVwKHBvcHVwKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVBsYWNlaG9sZGVycygpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1cGRhdGluZyBwbGFjZWhvbGRlcnMnKTtcbiAgICAgICAgICAgIGZldGNoKCcvY2FydC5qcycpXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgU3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oY2FydCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEV4YW1wbGU6IERpc3BsYXkgY2FydCBpdGVtcyBpbiBhIGRpdlxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjYXJ0LCAnY2FydCcpO1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jykuc3R5bGUub3ZlcmZsb3cgPSAnYXV0byc7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1vdXRwdXQnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbV9jb3VudCA9IGNhcnQuaXRlbV9jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYWNlaG9sZGVyJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhcnRJdGVtcyA9IGNhcnQuaXRlbXM7XG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVycy5mb3JFYWNoKHBsYWNlaG9sZGVyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2ZpbGxlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIuaW5uZXJIVE1MID0gJysnO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2lmdFNlbGVjdG9yc0FjdGl2ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5naWZ0X2NhcmRbZGF0YS1naWZ0XWApXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhcnRUb3RhbCA9IGNhcnQudG90YWxfcHJpY2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGdpZnRTZWxlY3RvcnNBY3RpdmUsIGNhcnRUb3RhbCwgJ2dpZnRTZWxlY3RvcnNBY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYoZ2lmdFNlbGVjdG9yc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgZ2lmdFNlbGVjdG9yc0FjdGl2ZS5mb3JFYWNoKGdpZnQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGdpZnQuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJylcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBnaWZ0LnF1ZXJ5U2VsZWN0b3IoJy5naWZ0LW92ZXJsYXknKS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1hY3RpdmUnKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGdpZnQucXVlcnlTZWxlY3RvcignLnRvcC1ub3RlJykuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJylcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBpZihnaWZ0LnF1ZXJ5U2VsZWN0b3IoJy5jb25mJykpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgZ2lmdC5xdWVyeVNlbGVjdG9yKCcuY29uZicpLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGxldCBnaWZ0TnVtYmVyID0gZ2lmdC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbW9uZXknKVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGlmIChjYXJ0VG90YWwgPj0gZ2lmdE51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBnaWZ0LmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGdpZnQucXVlcnlTZWxlY3RvcignLmdpZnQtb3ZlcmxheScpLmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGdpZnQucXVlcnlTZWxlY3RvcignLnRvcC1ub3RlJykuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJylcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgaWYoZ2lmdC5xdWVyeVNlbGVjdG9yKCcuY29uZicpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBnaWZ0LnF1ZXJ5U2VsZWN0b3IoJy5jb25mJykuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJylcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gRmlsbCBwbGFjZWhvbGRlcnMgd2l0aCBjYXJ0IGl0ZW1zXG4gICAgICAgICAgICAgICAgICAgIGNhcnRJdGVtcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbSwgaW5kZXgscGxhY2Vob2xkZXJzLmxlbmd0aCwgJ2l0ZW0sIGluZGV4Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPCBwbGFjZWhvbGRlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJzW2luZGV4XS5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPVwiJHtpdGVtLmltYWdlfVwiIGFsdD1cIiR7aXRlbS50aXRsZX1cIiBjbGFzcz1cInctZnVsbCBoLWZ1bGwgb2JqZWN0LWNvdmVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhYnNvbHV0ZSBiZy1ibGFjayBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciB3LVszMCVdIGgtWzMwJV0gYm90dG9tLVs1cHhdIHJpZ2h0LVs1cHhdXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cInRleHQtd2hpdGUgdGV4dC1jZW50ZXJcIj4ke2l0ZW0ucXVhbnRpdHl9PC9wPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWlkPVwiJHtpdGVtLmlkfVwiIGNsYXNzPVwiYWJzb2x1dGUgYmctWyNjMTQ0NDRdIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHctWzE2cHhdIGgtWzE2cHhdIHRvcC1bLThweF0gcmlnaHQtWy04cHhdIGpzLXJlbW92ZS1wcm9kdWN0IGN1cnNvci1wb2ludGVyIGNvbG9yLXdoaXRlIHJvdW5kZWQtWzUwJV1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLW91dHB1dCcpLmlubmVySFRNTCArPSBgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN0aWNreS1jYXJkLXByb2R1Y3Qgdy1bNTBweF0gaC1bNTBweF0gYmctd2hpdGUgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgcGxhY2Vob2xkZXIgcmVsYXRpdmVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9XCIke2l0ZW0uaW1hZ2V9XCIgYWx0PVwiJHtpdGVtLnRpdGxlfVwiIGNsYXNzPVwidy1mdWxsIGgtZnVsbCBvYmplY3QtY292ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFic29sdXRlIGJnLWJsYWNrIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHctWzMwJV0gaC1bMzAlXSBib3R0b20tWzVweF0gcmlnaHQtWzVweF1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPVwidGV4dC13aGl0ZSB0ZXh0LWNlbnRlclwiPiR7aXRlbS5xdWFudGl0eX08L3A+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtaWQ9XCIke2l0ZW0uaWR9XCIgY2xhc3M9XCJhYnNvbHV0ZSBiZy1bI2MxNDQ0NF0gZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdy1bMTZweF0gaC1bMTZweF0gdG9wLVstOHB4XSByaWdodC1bLThweF0ganMtcmVtb3ZlLXByb2R1Y3QgY3Vyc29yLXBvaW50ZXIgY29sb3Itd2hpdGUgcm91bmRlZC1bNTAlXVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhcnQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkb25lIHVwZGF0aW5nIHBsYWNlaG9sZGVycycpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGluaXRpYWxpemVUcmFja2luZ0JhcigpIHtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10cmFja2luZy1iYXItbWVzc2FnZV0nKTtcbiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtcHJvZ3Jlc3MtYmFyXScpO1xuICAgICAgICAgICAgY29uc3QgYmxvY2tzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS10cmFja2luZy1iYXItYmxvY2tzXSBsaScpKS5tYXAoKGJsb2NrKSA9PiAoe1xuICAgICAgICAgICAgICBpdGVtQ291bnQ6IHBhcnNlSW50KGJsb2NrLmdldEF0dHJpYnV0ZSgnZGF0YS1pdGVtLWNvdW50JyksIDEwKSxcbiAgICAgICAgICAgICAgcGVyY2VudGFnZU9mZjogcGFyc2VJbnQoYmxvY2suZ2V0QXR0cmlidXRlKCdkYXRhLXBlcmNlbnRhZ2Utb2ZmJyksIDEwKSxcbiAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgbGV0IGNhcnRJdGVtQ291bnQgPSAwO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYmxvY2tzLCAnYmxvY2tzJyk7XG5cblxuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVUcmFja2luZ0JhcigpIHtcbiAgICAgICAgICAgICAgbGV0IGN1cnJlbnRCbG9jayA9IG51bGw7XG4gICAgICAgICAgICAgIGxldCBuZXh0QmxvY2sgPSBudWxsO1xuXG4gICAgICAgICAgICAgIC8vIERldGVybWluZSB0aGUgY3VycmVudCBhbmQgbmV4dCBkaXNjb3VudCBibG9ja3NcbiAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBibG9ja3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoY2FydEl0ZW1Db3VudCA+PSBibG9ja3NbaV0uaXRlbUNvdW50KSB7XG4gICAgICAgICAgICAgICAgICBjdXJyZW50QmxvY2sgPSBibG9ja3NbaV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIG5leHRCbG9jayA9IGJsb2Nrc1tpXTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIC8vIFVwZGF0ZSBtZXNzYWdlIGFuZCBwcm9ncmVzcyBiYXJcbiAgICAgICAgICAgICAgaWYgKCFjdXJyZW50QmxvY2spIHtcbiAgICAgICAgICAgICAgICAvLyBCZWZvcmUgdGhlIGZpcnN0IGJsb2NrXG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbXNMZWZ0ID0gYmxvY2tzWzBdLml0ZW1Db3VudCAtIGNhcnRJdGVtQ291bnQ7XG4gICAgICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lci50ZXh0Q29udGVudCA9IGBBZGQgJHtpdGVtc0xlZnR9IG1vcmUgaXRlbXMgdG8gc2F2ZSAke2Jsb2Nrc1swXS5wZXJjZW50YWdlT2ZmfSUuYDtcbiAgICAgICAgICAgICAgICAvLyBjb25zdCBwcm9ncmVzcyA9IChjYXJ0SXRlbUNvdW50IC8gYmxvY2tzWzBdLml0ZW1Db3VudCkgKiAxMDA7XG4gICAgICAgICAgICAgICAgLy8gcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBgJHtwcm9ncmVzc30lYDtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmICghbmV4dEJsb2NrKSB7XG4gICAgICAgICAgICAgICAgLy8gTWF4aW11bSBkaXNjb3VudCByZWFjaGVkXG4gICAgICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lci50ZXh0Q29udGVudCA9IGBZb3UgYXJlIGF0IHlvdXIgbWF4aW11bSBkaXNjb3VudCBvZiAke2N1cnJlbnRCbG9jay5wZXJjZW50YWdlT2ZmfSUuYDtcbiAgICAgICAgICAgICAgICAvLyBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBCZXR3ZWVuIGJsb2Nrc1xuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1zTGVmdCA9IG5leHRCbG9jay5pdGVtQ291bnQgLSBjYXJ0SXRlbUNvdW50O1xuICAgICAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXIudGV4dENvbnRlbnQgPSBgWW91IGdldCAke2N1cnJlbnRCbG9jay5wZXJjZW50YWdlT2ZmfSUgb2ZmLiBBZGQgJHtpdGVtc0xlZnR9IG1vcmUgaXRlbXMgdG8gZ2V0ICR7bmV4dEJsb2NrLnBlcmNlbnRhZ2VPZmZ9JSBvZmYuYDtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9ncmVzcyA9ICgoY2FydEl0ZW1Db3VudCAtIGN1cnJlbnRCbG9jay5pdGVtQ291bnQpIC8gKG5leHRCbG9jay5pdGVtQ291bnQgLSBjdXJyZW50QmxvY2suaXRlbUNvdW50KSkgKiAxMDA7XG4gICAgICAgICAgICAgICAgLy8gcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBgJHtwcm9ncmVzc30lYDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjb25zdCBtYXhJdGVtcyA9IGJsb2Nrc1tibG9ja3MubGVuZ3RoIC0gMV0uaXRlbUNvdW50O1xuICAgICAgICAgICAgICBjb25zdCBwcm9ncmVzcyA9IE1hdGgubWluKChjYXJ0SXRlbUNvdW50IC8gbWF4SXRlbXMpICogMTAwLCAxMDApOyAvLyBDYXAgYXQgMTAwJVxuICAgICAgICAgICAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9IGAke3Byb2dyZXNzfSVgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gZmV0Y2hDYXJ0Q291bnQoKSB7XG4gICAgICAgICAgICAgICAgZmV0Y2goJy9jYXJ0LmpzJylcbiAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcbiAgICAgICAgICAgICAgICAgIC50aGVuKGNhcnQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjYXJ0SXRlbUNvdW50ID0gY2FydC5pdGVtX2NvdW50O1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVUcmFja2luZ0JhcigpO1xuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXJ0IGRhdGE6JywgZXJyb3IpKTtcbiAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgIC8vIEluaXRpYWwgc2V0dXBcbiAgICAgICAgICAgIGZldGNoQ2FydENvdW50KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldENhcnRJdGVtQ291bnQoKSB7XG4gICAgICAgICAgICBmZXRjaCgnL2NhcnQuanMnKVxuICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXG4gICAgICAgICAgICAgIC50aGVuKGNhcnQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1Db3VudCA9IGNhcnQuaXRlbV9jb3VudDsgLy8gVG90YWwgbnVtYmVyIG9mIGl0ZW1zIGluIHRoZSBjYXJ0XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0NhcnQgaXRlbSBjb3VudDonLCBpdGVtQ291bnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gVXNlIHRoaXMgdmFsdWUgdG8gdXBkYXRlIHlvdXIgdHJhY2tpbmcgYmFyIG9yIGFueSBvdGhlciBVSSBlbGVtZW50c1xuICAgICAgICAgICAgICAgIGluaXRpYWxpemVUcmFja2luZ0JhcihpdGVtQ291bnQpOyAvLyBFeGFtcGxlOiBIb29rIGludG8geW91ciB0cmFja2luZyBiYXIgbG9naWNcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXJ0IGRhdGE6JywgZXJyb3IpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGdldENhcnRJdGVtQ291bnQpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIHVwZGF0ZVBsYWNlaG9sZGVycyk7XG5cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlUHJvZHVjdChwcm9kdWN0SWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZW1vdmluZyBwcm9kdWN0JywgcHJvZHVjdElkKTtcbiAgICAgICAgICAgIGZldGNoKHdpbmRvdy5TaG9waWZ5LnJvdXRlcy5yb290ICsgJ2NhcnQvY2hhbmdlLmpzJywge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICBpZDogcHJvZHVjdElkLFxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogMFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIGlmKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVBsYWNlaG9sZGVycygpO1xuICAgICAgICAgICAgICAgICAgICBnZXRDYXJ0SXRlbUNvdW50KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVtb3ZlUHJvZHVjdEJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuanMtcmVtb3ZlLXByb2R1Y3QnKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldCAmJiBldmVudC50YXJnZXQubWF0Y2hlcygnLmpzLXJlbW92ZS1wcm9kdWN0JykpIHtcbiAgICAgICAgICAgICAgdmFyIGRhdGFJZCA9IGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKTsgLy8gUmV0cmlldmUgdGhlIGRhdGEtaWQgYXR0cmlidXRlXG4gICAgICAgICAgICAgIHJlbW92ZVByb2R1Y3QoZGF0YUlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHJlbW92ZVByb2R1Y3RCdXR0b25zLCAncmVtb3ZlUHJvZHVjdEJ1dHRvbnMnKTtcbiAgICAgICAgLy8gcmVtb3ZlUHJvZHVjdEJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xuICAgICAgICAvLyAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAvLyAgICAgICAgIGNvbnN0IHByb2R1Y3RJZCA9IGJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKTtcbiAgICAgICAgLy8gICAgICAgICByZW1vdmVQcm9kdWN0KHByb2R1Y3RJZCk7XG4gICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgLy8gQWRkIHRvIGNhcnQgbG9naWNcbiAgICAgICAgbGV0IGFkZFRvQ2FydHMgPSBzZWN0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuanMtYXRjLWJmXCIpICAvLyBTZWxlY3QgYWxsIGFkZCB0byBjYXJ0IGJ1dHRvbnNcbiAgICAgICAgY29uc29sZS5sb2coJ2RhIGxpIHNtbyBvdmRlZWUnKTtcbiAgICAgICAgYWRkVG9DYXJ0cy5mb3JFYWNoKChhZGRUb0NhcnQpID0+IHtcbiAgICAgICAgICAgIGFkZFRvQ2FydC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2xpY2tlZCcpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKS5zdHlsZS5vdmVyZmxvdyA9ICdhdXRvJztcbiAgICAgICAgICAgICAgICBsZXQgY2hlY2tvdXQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoYWRkVG9DYXJ0LmNsYXNzTGlzdC5jb250YWlucygnanMtY2hlY2tvdXQnKSkgeyAvLyBDaGVjayBpZiB0aGUgYnV0dG9uIGlzIGNoZWNrb3V0XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrb3V0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IF90aGlzID0gZS50YXJnZXQ7XG4gICAgICAgICAgICAgICAgbGV0IHByb2R1Y3RJZCA9IF90aGlzLmdldEF0dHJpYnV0ZShcImRhdGEtcHJvZHVjdC1pZFwiKTsgLy8gR2V0IHRoZSBwcm9kdWN0IGlkXG4gICAgICAgICAgICAgICAgbGV0IHF1YW50aXR5ID0gX3RoaXMuZ2V0QXR0cmlidXRlKFwiZGF0YS1xdWFudGl0eVwiKTsgLy8gR2V0IHRoZSBxdWFudGl0eVxuICAgICAgICAgICAgICAgIGNvbnN0IHVwc2VsbFByb2R1Y3RTZWxlY3RvcnMgPSBzZWN0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuanMtdXBzZWxsLXNlbGVjdG9yLmFjdGl2ZVwiKTsgLy8gR2V0IGFsbCBhY3RpdmUgdXBzZWxsIHByb2R1Y3RzXG4gICAgICAgICAgICAgICAgY29uc3QgYWRkSXRlbXMgPSBbXTsgLy8gQ3JlYXRlIGFuIGFycmF5IGZvciBpdGVtc1xuICAgICAgICAgICAgICAgIGFkZEl0ZW1zLnB1c2goeyAgLy8gQWRkIHRoZSBtYWluIHByb2R1Y3QgdG8gdGhlIGFycmF5XG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0SWQsXG4gICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiBxdWFudGl0eVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgdXBzZWxsUHJvZHVjdFNlbGVjdG9ycy5mb3JFYWNoKCh1cHNlbGxQcm9kdWN0U2VsZWN0b3IpID0+IHsgIC8vIEFkZCB1cHNlbGwgcHJvZHVjdHMgdG8gdGhlIGFycmF5XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb2R1Y3RJZCA9IHVwc2VsbFByb2R1Y3RTZWxlY3Rvci5nZXRBdHRyaWJ1dGUoXCJkYXRhLXByb2R1Y3QtaWRcIik7XG4gICAgICAgICAgICAgICAgICAgIGFkZEl0ZW1zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHByb2R1Y3RJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiAxLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhhZGRJdGVtcywgJ2FkZEl0ZW1zJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybURhdGEgPSB7IC8vIEZvcm0gZGF0YSBmb3IgdGhlIGNhcnRcbiAgICAgICAgICAgICAgICAgICAgaXRlbXM6IGFkZEl0ZW1zLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZmV0Y2god2luZG93LlNob3BpZnkucm91dGVzLnJvb3QgKyBcImNhcnQvYWRkLmpzXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGZvcm1EYXRhKSxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLnN0YXR1cywgXCJva1wiKTsgLy8gQ2hlY2sgaWYgdGhlIHJlc3BvbnNlIGlzIE9LXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXktbm93LXBvcHVwLmFjdGl2ZScpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1eS1ub3ctcG9wdXAuYWN0aXZlJykuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLnN0eWxlLm92ZXJmbG93ID0gJ2F1dG8nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVBsYWNlaG9sZGVycygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldENhcnRJdGVtQ291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCAmJiBjaGVja291dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9jaGVja291dCc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSlcbn0pO1xuXG5sZXQgZ3JpZEltYWdlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1ncmlkLWltYWdlJylcbmNvbnNvbGUubG9nKGdyaWRJbWFnZXMsICdncmlkSW1hZ2VzJyk7XG5ncmlkSW1hZ2VzLmZvckVhY2goZ3JpZEltYWdlID0+IHtcbiAgZ3JpZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICBsZXQgX3RoaXMgPSBncmlkSW1hZ2VcbiAgICBsZXQgaW1hZ2VRdHkgPSBfdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtaW1hZ2UtcXR5JylcbiAgICBsZXQgdHRxdWFudGl0eSA9IGdyaWRJbWFnZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLnF1YW50aXR5X19pbnB1dCcpXG4gICAgbGV0IGJ1eU1vcmUgPSBncmlkSW1hZ2UucGFyZW50Tm9kZS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5qcy1idXktbW9yZScpXG4gICAgbGV0IGF0YyA9IGdyaWRJbWFnZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5qcy1hdGMtYmYnKVxuICAgIGF0Yy5zZXRBdHRyaWJ1dGUoJ2RhdGEtcXVhbnRpdHknLCBpbWFnZVF0eSlcbiAgICBncmlkSW1hZ2UucGFyZW50Tm9kZS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5xdWFudGl0eV9fYnV0dG9uJykuY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZWQnKVxuICAgIHR0cXVhbnRpdHkudmFsdWUgPSBpbWFnZVF0eVxuICAgIGlmIChpbWFnZVF0eSA8IDEgJiYgYnV5TW9yZSkge1xuICAgICAgaW1hZ2VRdHkgPSAxXG4gICAgfVxuICAgIGlmIChpbWFnZVF0eSA8IDQgJiYgYnV5TW9yZSkge1xuICAgICAgYnV5TW9yZS50ZXh0Q29udGVudCA9ICdBZGQgNCBzYXZlIDU1JSUnXG4gICAgICBidXlNb3JlLnNldEF0dHJpYnV0ZSgnZGF0YS1jb3VudCcsIDQpXG4gICAgICBidXlNb3JlLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpXG4gICAgfVxuICAgIGlmIChpbWFnZVF0eSA+PSA0ICYmIGltYWdlUXR5IDwgNiAmJiBidXlNb3JlKSB7XG4gICAgICBidXlNb3JlLnRleHRDb250ZW50ID0gJ0FkZCA2IHNhdmUgNjUlJ1xuICAgICAgYnV5TW9yZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtY291bnQnLCA2KVxuICAgICAgYnV5TW9yZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKVxuICAgIH1cbiAgICBpZiAoaW1hZ2VRdHkgPj0gNiAmJiBidXlNb3JlKSB7XG4gICAgICBidXlNb3JlLnRleHRDb250ZW50ID0gJ0FkZCAxMCBzYXZlIDgwJSdcbiAgICAgIGJ1eU1vcmUuc2V0QXR0cmlidXRlKCdkYXRhLWNvdW50JywgMTApXG4gICAgICBidXlNb3JlLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpXG4gICAgfVxuICAgIGlmIChpbWFnZVF0eSA8IDEwICYmIGJ1eU1vcmUpIHtcbiAgICAgIGJ1eU1vcmUuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJylcbiAgICB9XG4gICAgaWYgKGltYWdlUXR5ID49IDEwICYmIGJ1eU1vcmUpIHtcbiAgICAgIGJ1eU1vcmUuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJylcbiAgICB9XG4gIH0pXG59KVxuZnVuY3Rpb24gaW5pdGlhbGl6ZVN0aWNreVRyYWNraW5nQmFyKCkge1xuICAgIGNvbnN0IHRyYWNraW5nQmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtdHJhY2tpbmctYmFyXScpO1xuICAgIGNvbnN0IHN0aWNreUNsYXNzID0gJ3N0aWNreS1iYXInO1xuXG4gICAgZnVuY3Rpb24gaGFuZGxlU3RpY2t5QmVoYXZpb3IoKSB7XG4gICAgICBjb25zdCBzY3JvbGxQb3NpdGlvbiA9IHdpbmRvdy5zY3JvbGxZOyAvLyBDdXJyZW50IHZlcnRpY2FsIHNjcm9sbCBwb3NpdGlvblxuICAgICAgY29uc3Qgdmlld3BvcnRIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7IC8vIFZpZXdwb3J0IGhlaWdodFxuXG4gICAgICBpZiAoc2Nyb2xsUG9zaXRpb24gPiA0MCB8fCB2aWV3cG9ydEhlaWdodCA8IDQwKSB7XG4gICAgICAgIHRyYWNraW5nQmFyLmNsYXNzTGlzdC5hZGQoc3RpY2t5Q2xhc3MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHJhY2tpbmdCYXIuY2xhc3NMaXN0LnJlbW92ZShzdGlja3lDbGFzcyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQXR0YWNoIHNjcm9sbCBhbmQgcmVzaXplIGV2ZW50IGxpc3RlbmVyc1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBoYW5kbGVTdGlja3lCZWhhdmlvcik7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGhhbmRsZVN0aWNreUJlaGF2aW9yKTtcblxuICAgIC8vIEluaXRpYWwgY2hlY2tcbiAgICBoYW5kbGVTdGlja3lCZWhhdmlvcigpO1xufVxuaW5pdGlhbGl6ZVN0aWNreVRyYWNraW5nQmFyKCk7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/modules/bf/bf.js\n");

/***/ }),

/***/ "./src/scripts/entries/section/bf.js":
/*!*******************************************!*\
  !*** ./src/scripts/entries/section/bf.js ***!
  \*******************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var lib_components__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lib/components */ \"./src/scripts/lib/components.js\");\n/* harmony import */ var modules_bf_bf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! modules/bf/bf.js */ \"./src/modules/bf/bf.js\");\n\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  (0,lib_components__WEBPACK_IMPORTED_MODULE_0__.initComponent)(modules_bf_bf_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"], 'Bf');\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2NyaXB0cy9lbnRyaWVzL3NlY3Rpb24vYmYuanMiLCJtYXBwaW5ncyI6Ijs7O0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL3Nob3BpZnktYmFzZS0yLjAvLi9zcmMvc2NyaXB0cy9lbnRyaWVzL3NlY3Rpb24vYmYuanM/ZTUyZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpbml0Q29tcG9uZW50IH0gZnJvbSAnbGliL2NvbXBvbmVudHMnXG5pbXBvcnQgQmYgZnJvbSAnbW9kdWxlcy9iZi9iZi5qcydcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcbiAgaW5pdENvbXBvbmVudChCZiwgJ0JmJylcbn0pXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/scripts/entries/section/bf.js\n");

/***/ }),

/***/ "./src/modules/bf/bf.css":
/*!*******************************!*\
  !*** ./src/modules/bf/bf.css ***!
  \*******************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbW9kdWxlcy9iZi9iZi5jc3MiLCJtYXBwaW5ncyI6IjtBQUFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2hvcGlmeS1iYXNlLTIuMC8uL3NyYy9tb2R1bGVzL2JmL2JmLmNzcz8yYzFlIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGV4dHJhY3RlZCBieSBtaW5pLWNzcy1leHRyYWN0LXBsdWdpblxuZXhwb3J0IHt9OyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/modules/bf/bf.css\n");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ var __webpack_exec__ = function(moduleId) { return __webpack_require__(__webpack_require__.s = moduleId); }
/******/ __webpack_require__.O(0, ["commons"], function() { return __webpack_exec__("./src/scripts/entries/section/bf.js"); });
/******/ var __webpack_exports__ = __webpack_require__.O();
/******/ }
]);