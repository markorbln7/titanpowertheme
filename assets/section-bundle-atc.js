"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkshopify_base_2_0"] = self["webpackChunkshopify_base_2_0"] || []).push([["section-bundle-atc"],{

/***/ "./src/modules/bundle/bundle-atc.js":
/*!******************************************!*\
  !*** ./src/modules/bundle/bundle-atc.js ***!
  \******************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _bundle_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./bundle.css */ \"./src/modules/bundle/bundle.css\");\n/* eslint-disable */\n\nconst tabs = document.querySelectorAll('.section-bundle__collection-tab');\n// const cartSample = {\n//     \"items\":[]\n// }\nlet cartSample = {\n  \"items\": []\n};\nconst generateCart = () => {\n  let activeProduct = document.querySelectorAll('.active-item');\n  cartSample = {\n    \"items\": []\n  };\n  let totalQty = 0;\n  activeProduct.forEach(product => {\n    let image = product.getAttribute('data-image');\n    let id = product.getAttribute('data-item-id');\n    let quantity = product.getAttribute('data-item-qty');\n    let price = product.getAttribute('data-item-price');\n    let comparePrice = product.getAttribute('data-item-compare-price');\n    cartSample.items.push({\n      \"type\": \"product\",\n      \"id\": id,\n      \"quantity\": quantity,\n      \"variant_id\": 42160297509042,\n      \"comparePrice\": comparePrice,\n      \"price\": price,\n      \"image\": image\n    });\n  });\n  let firstGift = parseInt(document.querySelector('.first-gift').getAttribute('data-gift-ammount'));\n  let firstGiftImage = document.querySelector('.first-gift img').src;\n  let secondGift = parseInt(document.querySelector('.second-gift').getAttribute('data-gift-ammount'));\n  let secondGiftImage = document.querySelector('.second-gift img').src;\n  cartSample.items.forEach(item => {\n    totalQty += parseInt(item.price * item.quantity);\n  });\n  if (totalQty >= firstGift) {\n    cartSample.items.push({\n      \"type\": \"gift\",\n      \"quantity\": 1,\n      \"variant_id\": 42160297509042,\n      \"comparePrice\": 0,\n      \"price\": 0,\n      \"image\": firstGiftImage\n    });\n  }\n  if (totalQty >= secondGift) {\n    cartSample.items.push({\n      \"type\": \"gift\",\n      \"quantity\": 1,\n      \"variant_id\": 42160297509042,\n      \"comparePrice\": 0,\n      \"price\": 0,\n      \"image\": secondGiftImage\n    });\n  }\n  console.log(firstGift, secondGift, totalQty, 'totalQty');\n  if (totalQty > 0) {\n    document.querySelector('.js-atc').removeAttribute('disabled');\n    document.querySelector('.js-checkout-now').removeAttribute('disabled');\n  }\n  if (totalQty < 1) {\n    document.querySelector('.js-atc').setAttribute('disabled', true);\n    document.querySelector('.js-checkout-now').setAttribute('disabled', true);\n  }\n  return cartSample;\n};\ntabs.forEach(tab => {\n  tab.addEventListener('click', () => {\n    setActive(tab);\n    showPanel(tab);\n  });\n});\nconst setActive = function (el) {\n  [...el.parentElement.children].forEach(function (sib) {\n    sib.classList.remove('active');\n  });\n  el.classList.add('active');\n};\nconst showPanel = tab => {\n  let tabIndex = tab.getAttribute('data-tab');\n  let panels = document.querySelectorAll('.section-bundle__products-holder');\n  panels.forEach(panel => {\n    const panelIndex = panel.getAttribute('data-panel');\n    if (panelIndex === tabIndex) {\n      panel.classList.add('active');\n    } else {\n      panel.classList.remove('active');\n    }\n  });\n};\n\n//SWIPER FOR BUNDLE CART CAROUSEL\n\nvar swiper = new Swiper('.section-bundle__cart-carousel', {\n  spaceBetween: 8,\n  slidesPerView: 4,\n  slidesPerGroup: 4,\n  breakpoints: {\n    768: {\n      slidesPerView: 6,\n      slidesPerGroup: 6,\n      draggable: false\n    }\n  },\n  navigation: {\n    nextEl: '.section-bundle__cart-carousel .swiper-button-next',\n    prevEl: '.section-bundle__cart-carousel .swiper-button-prev'\n  },\n  scrollbar: {\n    el: '.section-bundle__cart-carousel .swiper-scrollbar',\n    draggable: true\n  }\n});\n\n//TOGGLE BUNDLE\nconst bundleCarousel = document.querySelector('.bundle-wrap');\nconst bundleToggler = document.querySelector('.js-bundle-toggle');\nbundleToggler.addEventListener('click', () => {\n  bundleCarousel.classList.toggle('hide-bundle');\n  if (bundleCarousel.classList.contains('hide-bundle')) {\n    bundleToggler.textContent = 'SHOW BUNDLE';\n  } else {\n    bundleToggler.textContent = 'HIDE BUNDLE';\n  }\n});\n\n//ADD TO CART LOGIC\nconst bundleAtcButtons = document.querySelectorAll('.js-atc');\nif (bundleAtcButtons) {\n  bundleAtcButtons.forEach(atcButton => {\n    atcButton.addEventListener('click', e => {\n      let overlayBundle = document.querySelector('.bundle-overlay');\n      overlayBundle.classList.add('show');\n      let idSelectors = document.querySelectorAll('.js-id-selector');\n      e.preventDefault();\n      let addItems = [];\n      idSelectors.forEach(idSelector => {\n        let id = idSelector.getAttribute('data-item-id');\n        let quantity = idSelector.getAttribute('data-item-qty');\n        if (quantity > 0) {\n          addItems.push({\n            id: id,\n            quantity: quantity\n          });\n        }\n      });\n      const formData = {\n        items: addItems\n      };\n      fetch(window.Shopify.routes.root + 'cart/add.js', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(formData)\n      }).then(response => {\n        if (response.status === 200) {\n          console.log(response.status, 'ok');\n          overlayBundle.classList.remove('show');\n        }\n        return response.json();\n      }).catch(error => {\n        console.error('Error:', error);\n      });\n    });\n  });\n}\nconst bundleCheckoutButtons = document.querySelectorAll('.js-checkout-now');\nif (bundleCheckoutButtons) {\n  bundleCheckoutButtons.forEach(bundleCheckoutButton => {\n    bundleCheckoutButton.addEventListener('click', async e => {\n      await clearCart();\n    });\n  });\n}\nasync function clearCart() {\n  document.querySelector('#rebuy-cart').style.visibility = \"hidden\";\n  fetch('/cart/clear.js', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  }).then(response => {\n    if (response.ok) {\n      console.log('Cart cleared successfully');\n      return AtC();\n    } else {\n      console.error('Failed to clear cart');\n    }\n  }).catch(error => {\n    console.error('Error clearing cart:', error);\n  });\n}\nfunction AtC() {\n  let overlayBundle = document.querySelector('.bundle-overlay');\n  overlayBundle.classList.add('show');\n  let idSelectors = document.querySelectorAll('.js-id-selector');\n  let addItems = [];\n  idSelectors.forEach(idSelector => {\n    let id = idSelector.getAttribute('data-item-id');\n    let quantity = idSelector.getAttribute('data-item-qty');\n    if (quantity > 0) {\n      addItems.push({\n        id: id,\n        quantity: quantity\n      });\n    }\n  });\n  const formData = {\n    items: addItems\n  };\n  fetch(window.Shopify.routes.root + 'cart/add.js', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(formData)\n  }).then(response => {\n    if (response.status === 200) {\n      console.log(response.status, 'ok');\n      window.location.href = '/checkout';\n      overlayBundle.classList.remove('show');\n    }\n    return response.json();\n  }).catch(error => {\n    console.error('Error:', error);\n  });\n}\nasync function refreshCart() {\n  const cart = cartSample;\n  const bundleItems = document.querySelectorAll('.section-bundle__cart-carousel-item');\n  const bundleHolder = document.querySelector('.js-holder');\n  bundleHolder.innerHTML = '';\n  for (let i = 0; i < 12; i++) {\n    if (cart.items[i]) {\n      bundleHolder.innerHTML += `\n        <div class=\"swiper-slide p-[18px]\">\n            <div class=\"section-bundle__cart-carousel-item flex-col\">\n\n                <div class=\"qty-holder\">${cart.items[i].quantity > 1 ? cart.items[i].quantity : ''}</div>\n                <img class=\"\" src=\"${cart.items[i].image}\">\n            </div>\n        </div>\n        `;\n    } else {\n      bundleHolder.innerHTML += `\n            <div class=\"swiper-slide\">\n                <div class=\"section-bundle__cart-carousel-item\">\n                    <div class=\"col-quantity__button increase  p dm-sans-normal color-white text-center\">+</div>\n                </div>\n            </div>\n            `;\n    }\n    // if(cart.items[i] && document.querySelector('.class-' + cart.items[i].product_id)) {\n    //     let selector = document.querySelector('.class-' + cart.items[i].product_id)\n    //     selector.querySelector('.js-qty-number').innerHTML = cart.items[i].quantity;\n    //     selector.querySelector('.plus').setAttribute('data-quantity', cart.items[i].quantity + 1);\n    //     selector.querySelector('.minus').setAttribute('data-quantity', cart.items[i].quantity -1 );\n    // }\n  }\n\n  var swiper = new Swiper('.section-bundle__cart-carousel', {\n    spaceBetween: 8,\n    slidesPerView: 4,\n    slidesPerGroup: 4,\n    breakpoints: {\n      768: {\n        slidesPerView: 6,\n        slidesPerGroup: 6,\n        draggable: false\n      }\n    },\n    navigation: {\n      nextEl: '.section-bundle__cart-carousel .swiper-button-next',\n      prevEl: '.section-bundle__cart-carousel .swiper-button-prev'\n    },\n    scrollbar: {\n      el: '.section-bundle__cart-carousel .swiper-scrollbar',\n      draggable: true\n    }\n  });\n  let allQty = document.querySelectorAll('.js-qty-number');\n  let qty = 0;\n  cart.items.forEach(item => {\n    if (item.type !== 'gift') {\n      qty += parseInt(item.quantity);\n    }\n  });\n  let points = document.querySelectorAll('.point');\n  let allLines = document.querySelectorAll('.line');\n  let allNumber = 0;\n  for (let y = 0; y < allQty.length; y++) {\n    allNumber += parseFloat(allQty[y].innerHTML);\n  }\n  points.forEach((point, index) => {\n    if (point) {\n      point.style.backgroundColor = '#adadad';\n    }\n  });\n  allLines.forEach((allLine, index) => {\n    if (allLine) {\n      allLine.style.backgroundColor = '#adadad';\n    }\n  });\n  for (let z = 0; z < qty; z++) {\n    if (points[z]) {\n      points[z].style.backgroundColor = '#60c655';\n    }\n  }\n  let limiter = qty * 2 - 1;\n  for (let k = 0; k < limiter; k++) {\n    if (allLines[k]) {\n      allLines[k].style.backgroundColor = '#60c655';\n    }\n  }\n  setTimeout(() => {\n    document.querySelectorAll('.js-remove').forEach(remove => {\n      remove.addEventListener('click', () => {\n        let itemId = remove.getAttribute('data-variant-id');\n        let productId = remove.getAttribute('data-product-id');\n        fetch(window.Shopify.routes.root + 'cart/change.js', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            id: itemId,\n            quantity: 0\n          })\n        }).then(response => {\n          console.log(response.status);\n          if (response.status === 200) {\n            console.log(response.status, 'okkkk');\n            let selector = document.querySelector('.class-' + productId);\n            selector.querySelector('.js-qty-number').innerHTML = 0;\n            selector.querySelector('.plus').setAttribute('data-quantity', 1);\n            selector.querySelector('.minus').setAttribute('data-quantity', 0);\n            refreshCart();\n          }\n          return response.json();\n        }).catch(error => {\n          console.error('Error:', error);\n        });\n      });\n    });\n  }, 2000);\n  let totalPrice = 0;\n  let comparePrice = 0;\n  let totalQty = 0;\n  cart.items.forEach(item => {\n    if (item.type !== 'gift') {\n      console.log(item.type, 'gift');\n      totalQty += parseInt(item.quantity);\n      totalPrice += item.price * item.quantity;\n      comparePrice += item.comparePrice * item.quantity;\n    }\n  });\n  console.log(totalQty, 'duzina');\n  if (totalQty >= 5 && totalQty < 7) {\n    totalPrice = totalPrice * 0.9;\n    console.log('usao u 5');\n  } else if (totalQty >= 7 && totalQty < 10) {\n    console.log('usao u 7');\n    totalPrice = totalPrice * 0.7;\n  } else if (totalQty >= 10) {\n    console.log('usao u 10');\n    totalPrice = totalPrice * 0.6;\n  }\n  // if(totalQty >= 7) {\n  //     totalPrice = totalPrice * 0.7;\n  // }\n  // if(totalQty > 10) {\n  //     totalPrice = totalPrice * 0.6;\n  // }\n  async function getCart() {\n    const result = await fetch(\"/cart.json\");\n    if (result.status === 200) {\n      return result.json();\n    }\n    throw new Error(`Failed to get request, Shopify returned ${result.status} ${result.statusText}`);\n  }\n  let cartSymbol = await getCart();\n  let currencySymbol = cartSymbol.currency;\n  if (currencySymbol == 'USD') {\n    currencySymbol = '$';\n  }\n  if (currencySymbol == 'EUR') {\n    currencySymbol = '€';\n  }\n  if (currencySymbol == 'GBP') {\n    currencySymbol = '£';\n  }\n  const formattedPrice = currencySymbol + (totalPrice / 100).toFixed(2);\n  const formattedPriceCompare = currencySymbol + (comparePrice / 100).toFixed(2);\n  const totalPriceElement = document.querySelector('.section-bundle__sticky-price');\n  const totalPriceElementCompare = document.querySelector('.section-bundle__sticky-price-compare');\n  totalPriceElement.textContent = formattedPrice;\n  if (comparePrice > 0) {\n    totalPriceElementCompare.textContent = formattedPriceCompare;\n  } else {\n    totalPriceElementCompare.textContent = '';\n  }\n  console.log('Refreshed cart');\n}\nconst pluses = document.querySelectorAll('.plus');\nconst minuses = document.querySelectorAll('.minus');\npluses.forEach(pluse => {\n  pluse.addEventListener('click', () => {\n    let parentElement = pluse.parentNode;\n    parentElement.classList.add('active-item');\n    let past = parentElement.querySelector('.minus');\n    let now = parentElement;\n    let future = parentElement.querySelector('.plus');\n    let nowNumber = now.getAttribute('data-item-qty');\n    let futureNumber = future.getAttribute('data-quantity');\n    let pastNumber = past.getAttribute('data-quantity');\n    nowNumber = parseInt(nowNumber) + 1;\n    futureNumber = parseInt(futureNumber) + 1;\n    pastNumber = parseInt(pastNumber) + 1;\n    now.setAttribute('data-item-qty', nowNumber);\n    now.querySelector('.js-qty-number').innerHTML = nowNumber;\n    past.setAttribute('data-quantity', pastNumber);\n    future.setAttribute('data-quantity', futureNumber);\n    let image = parentElement.getAttribute('data-image');\n    let id = parentElement.getAttribute('data-item-id');\n    generateCart();\n    refreshCart();\n  });\n});\nminuses.forEach(minus => {\n  minus.addEventListener('click', () => {\n    let parentElement = minus.parentNode;\n    let past = parentElement.querySelector('.minus');\n    let now = parentElement;\n    let future = parentElement.querySelector('.plus');\n    let nowNumber = now.getAttribute('data-item-qty');\n    let futureNumber = future.getAttribute('data-quantity');\n    let pastNumber = past.getAttribute('data-quantity');\n    if (nowNumber > 0) {\n      nowNumber = parseInt(nowNumber) - 1;\n    }\n    if (futureNumber > 0) {\n      futureNumber = parseInt(futureNumber) - 1;\n    }\n    if (futureNumber > 0) {\n      pastNumber;\n    }\n    if (nowNumber < 1) {\n      parentElement.classList.remove('active-item');\n    }\n    now.setAttribute('data-item-qty', nowNumber);\n    now.querySelector('.js-qty-number').innerHTML = nowNumber;\n    past.setAttribute('data-quantity', pastNumber);\n    future.setAttribute('data-quantity', futureNumber);\n    generateCart();\n    refreshCart();\n    // updateCart(itemId, quantity);\n    // minus.setAttribute('data-quantity', newValue)\n    // setTimeout(() => {\n    //     refreshCart();\n    // }, 1000)\n  });\n});\n\nlet infoTrigers = document.querySelectorAll('.info-icon-trigger');\nlet closeBtn = document.querySelector('.close');\ninfoTrigers.forEach(infoTriger => {\n  infoTriger.addEventListener('click', e => {\n    let infoImage = e.target.getAttribute('data-image');\n    document.querySelector('.info-image').src = infoImage;\n    document.querySelector('.product-overlay').classList.add('show');\n    document.querySelector('body').classList.add('no-scroll');\n    document.querySelector('html').classList.add('no-scroll');\n  });\n});\ncloseBtn.addEventListener('click', e => {\n  document.querySelector('.product-overlay').classList.remove('show');\n  document.querySelector('body').classList.remove('no-scroll');\n  document.querySelector('html').classList.remove('no-scroll');\n});\nlet infoPlayTrigers = document.querySelectorAll('.js-video-trig');\nlet closePlayBtn = document.querySelector('.close-play');\ninfoPlayTrigers.forEach(infoTriger => {\n  infoTriger.addEventListener('click', e => {\n    let infoVideo = e.target.getAttribute('data-video');\n    document.querySelector('.info-video').src = infoVideo;\n    document.querySelector('.product-play-overlay').classList.add('show');\n    document.querySelector('body').classList.add('no-scroll');\n    document.querySelector('html').classList.add('no-scroll');\n    setTimeout(() => {\n      document.querySelector('.info-video').play();\n    }, 300);\n  });\n});\nclosePlayBtn.addEventListener('click', e => {\n  document.querySelector('.product-play-overlay').classList.remove('show');\n  document.querySelector('body').classList.remove('no-scroll');\n  document.querySelector('html').classList.remove('no-scroll');\n  document.querySelector('.info-video').pause();\n});\nlet overlayCls = document.querySelector('.product-play-overlay');\noverlayCls.addEventListener('click', e => {\n  if (e.target.classList.contains('product-play-overlay')) {\n    document.querySelector('.product-play-overlay').classList.remove('show');\n    document.querySelector('body').classList.remove('no-scroll');\n    document.querySelector('html').classList.remove('no-scroll');\n    document.querySelector('.info-video').pause();\n  }\n});\nlet overlayClsImage = document.querySelector('.product-overlay');\noverlayClsImage.addEventListener('click', e => {\n  document.querySelector('.product-overlay').classList.remove('show');\n  document.querySelector('body').classList.remove('no-scroll');\n  document.querySelector('html').classList.remove('no-scroll');\n});\nrefreshCart();\nconst distanceTracker = $('.bundle-wrap').offset().top;\n$(window).scroll(function () {\n  const top_of_element = $('#shopify-section-footer').offset().top;\n  const bottom_of_element = $('#shopify-section-footer').offset().top + $('#shopify-section-footer').outerHeight();\n  const bottom_of_screen = $(window).scrollTop() + $(window).innerHeight();\n  const top_of_screen = $(window).scrollTop();\n  if (!(bottom_of_screen > top_of_element) && top_of_screen < bottom_of_element && $(this).scrollTop() >= distanceTracker) {\n    $('.section-bundle__tracker').addClass('tracker-fixed');\n  } else {\n    $('.section-bundle__tracker').removeClass('tracker-fixed');\n  }\n});\ndocument.addEventListener('DOMContentLoaded', function () {\n  document.querySelectorAll('.product').forEach(productElement => {\n    const productId = productElement.getAttribute('data-product-id');\n    const selectors = productElement.querySelectorAll('.variant-selectors select');\n    const addToCartButton = productElement.querySelector('.js-id-selector');\n    const price = productElement.querySelector('.js-regular-price');\n    const comparePrice = productElement.querySelector('.js-compare-price');\n    const idSelector = productElement.querySelector('.js-id-selector');\n    function getVariantId(selectedOptions) {\n      const productVariants = window.productVariants[productId];\n      const variant = productVariants.find(variant => variant.options.every((option, index) => option === selectedOptions[index]));\n      return variant ? variant.id : '';\n    }\n    function getVariantPrice(selectedOptions) {\n      const productVariants = window.productVariants[productId];\n      const variant = productVariants.find(variant => variant.options.every((option, index) => option === selectedOptions[index]));\n      return variant ? variant.priceMoney : '';\n    }\n    function getVariantPriceRaw(selectedOptions) {\n      const productVariants = window.productVariants[productId];\n      const variant = productVariants.find(variant => variant.options.every((option, index) => option === selectedOptions[index]));\n      return variant ? variant.priceRaw : '';\n    }\n    function getVariantComparePrice(selectedOptions) {\n      const productVariants = window.productVariants[productId];\n      const variant = productVariants.find(variant => variant.options.every((option, index) => option === selectedOptions[index]));\n      return variant ? variant.comparepriceMoney : '';\n    }\n    function getVariantComparePriceRaw(selectedOptions) {\n      const productVariants = window.productVariants[productId];\n      const variant = productVariants.find(variant => variant.options.every((option, index) => option === selectedOptions[index]));\n      return variant ? variant.comparepriceRaw : '';\n    }\n    function updateAddToCartButton() {\n      let selectedOptions = [];\n      selectors.forEach(selector => {\n        selectedOptions.push(selector.value);\n      });\n      const variantId = getVariantId(selectedOptions);\n      const variantPrice = getVariantPrice(selectedOptions);\n      const variantComparePrice = getVariantComparePrice(selectedOptions);\n      const variantPriceRaw = getVariantPriceRaw(selectedOptions);\n      const variantComparePriceRaw = getVariantComparePriceRaw(selectedOptions);\n      if (variantPrice) {\n        price.textContent = variantPrice;\n      }\n      if (variantComparePrice) {\n        comparePrice.textContent = variantComparePrice;\n      }\n      if (variantId) {\n        addToCartButton.setAttribute('data-item-id', variantId);\n      }\n      if (variantPriceRaw) {\n        idSelector.setAttribute('data-item-price', variantPriceRaw);\n      }\n      if (variantComparePriceRaw) {\n        idSelector.setAttribute('data-item-compare-price', variantComparePriceRaw);\n      }\n    }\n    selectors.forEach(selector => {\n      selector.addEventListener('change', updateAddToCartButton);\n    });\n    updateAddToCartButton();\n  });\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbW9kdWxlcy9idW5kbGUvYnVuZGxlLWF0Yy5qcyIsIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zaG9waWZ5LWJhc2UtMi4wLy4vc3JjL21vZHVsZXMvYnVuZGxlL2J1bmRsZS1hdGMuanM/OWQxOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSAqL1xuaW1wb3J0ICcuL2J1bmRsZS5jc3MnXG5cbmNvbnN0IHRhYnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2VjdGlvbi1idW5kbGVfX2NvbGxlY3Rpb24tdGFiJyk7XG4vLyBjb25zdCBjYXJ0U2FtcGxlID0ge1xuLy8gICAgIFwiaXRlbXNcIjpbXVxuLy8gfVxubGV0IGNhcnRTYW1wbGUgPSB7XG4gICAgXCJpdGVtc1wiOltdXG59XG5cbmNvbnN0IGdlbmVyYXRlQ2FydCA9ICgpID0+IHtcbiAgICBsZXQgYWN0aXZlUHJvZHVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hY3RpdmUtaXRlbScpXG4gICAgY2FydFNhbXBsZSA9IHtcbiAgICAgICAgXCJpdGVtc1wiOltdXG4gICAgfVxuICAgIGxldCB0b3RhbFF0eSA9IDA7XG4gICAgYWN0aXZlUHJvZHVjdC5mb3JFYWNoKChwcm9kdWN0KSA9PiB7XG4gICAgICAgIGxldCBpbWFnZSA9IHByb2R1Y3QuZ2V0QXR0cmlidXRlKCdkYXRhLWltYWdlJylcbiAgICAgICAgbGV0IGlkID0gcHJvZHVjdC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaXRlbS1pZCcpXG4gICAgICAgIGxldCBxdWFudGl0eSA9IHByb2R1Y3QuZ2V0QXR0cmlidXRlKCdkYXRhLWl0ZW0tcXR5JylcbiAgICAgICAgbGV0IHByaWNlID0gcHJvZHVjdC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaXRlbS1wcmljZScpXG4gICAgICAgIGxldCBjb21wYXJlUHJpY2UgPSBwcm9kdWN0LmdldEF0dHJpYnV0ZSgnZGF0YS1pdGVtLWNvbXBhcmUtcHJpY2UnKVxuICAgICAgICBjYXJ0U2FtcGxlLml0ZW1zLnB1c2goe1xuICAgICAgICAgICAgXCJ0eXBlXCI6XCJwcm9kdWN0XCIsXG4gICAgICAgICAgICBcImlkXCI6aWQsXG4gICAgICAgICAgICBcInF1YW50aXR5XCI6cXVhbnRpdHksXG4gICAgICAgICAgICBcInZhcmlhbnRfaWRcIjo0MjE2MDI5NzUwOTA0MixcbiAgICAgICAgICAgIFwiY29tcGFyZVByaWNlXCI6Y29tcGFyZVByaWNlLFxuICAgICAgICAgICAgXCJwcmljZVwiOnByaWNlLFxuICAgICAgICAgICAgXCJpbWFnZVwiOmltYWdlXG4gICAgICAgIH0pXG4gICAgfSlcbiAgICBsZXQgZmlyc3RHaWZ0ID0gcGFyc2VJbnQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZpcnN0LWdpZnQnKS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZ2lmdC1hbW1vdW50JykpXG4gICAgbGV0IGZpcnN0R2lmdEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZpcnN0LWdpZnQgaW1nJykuc3JjXG4gICAgbGV0IHNlY29uZEdpZnQgPSBwYXJzZUludChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2Vjb25kLWdpZnQnKS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZ2lmdC1hbW1vdW50JykpXG4gICAgbGV0IHNlY29uZEdpZnRJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWNvbmQtZ2lmdCBpbWcnKS5zcmNcbiAgICBjYXJ0U2FtcGxlLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIHRvdGFsUXR5ICs9IHBhcnNlSW50KGl0ZW0ucHJpY2UgKiBpdGVtLnF1YW50aXR5KTtcbiAgICB9KTtcbiAgICBpZih0b3RhbFF0eSA+PSBmaXJzdEdpZnQpIHtcbiAgICAgICAgY2FydFNhbXBsZS5pdGVtcy5wdXNoKHtcbiAgICAgICAgICAgIFwidHlwZVwiOlwiZ2lmdFwiLFxuICAgICAgICAgICAgXCJxdWFudGl0eVwiOjEsXG4gICAgICAgICAgICBcInZhcmlhbnRfaWRcIjo0MjE2MDI5NzUwOTA0MixcbiAgICAgICAgICAgIFwiY29tcGFyZVByaWNlXCI6MCxcbiAgICAgICAgICAgIFwicHJpY2VcIjowLFxuICAgICAgICAgICAgXCJpbWFnZVwiOmZpcnN0R2lmdEltYWdlXG4gICAgICAgIH0pXG4gICAgfVxuICAgIGlmKHRvdGFsUXR5ID49IHNlY29uZEdpZnQpIHtcbiAgICAgICAgY2FydFNhbXBsZS5pdGVtcy5wdXNoKHtcbiAgICAgICAgICAgIFwidHlwZVwiOlwiZ2lmdFwiLFxuICAgICAgICAgICAgXCJxdWFudGl0eVwiOjEsXG4gICAgICAgICAgICBcInZhcmlhbnRfaWRcIjo0MjE2MDI5NzUwOTA0MixcbiAgICAgICAgICAgIFwiY29tcGFyZVByaWNlXCI6MCxcbiAgICAgICAgICAgIFwicHJpY2VcIjowLFxuICAgICAgICAgICAgXCJpbWFnZVwiOnNlY29uZEdpZnRJbWFnZVxuICAgICAgICB9KVxuICAgIH1cbiAgICBjb25zb2xlLmxvZyhmaXJzdEdpZnQsc2Vjb25kR2lmdCx0b3RhbFF0eSwgJ3RvdGFsUXR5JylcbiAgICBpZih0b3RhbFF0eSA+IDApIHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLWF0YycpLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKVxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtY2hlY2tvdXQtbm93JykucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpXG4gICAgfVxuICAgIGlmKHRvdGFsUXR5IDwgMSkge1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtYXRjJykuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1jaGVja291dC1ub3cnKS5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSlcbiAgICB9XG4gICAgcmV0dXJuIGNhcnRTYW1wbGU7XG59XG5cbnRhYnMuZm9yRWFjaCh0YWIgPT4ge1xuICAgIHRhYi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgc2V0QWN0aXZlKHRhYik7XG4gICAgICAgIHNob3dQYW5lbCh0YWIpO1xuICAgIH0pO1xufSk7XG5cbmNvbnN0IHNldEFjdGl2ZSA9IGZ1bmN0aW9uIChlbCkge1xuICAgIFsuLi5lbC5wYXJlbnRFbGVtZW50LmNoaWxkcmVuXS5mb3JFYWNoKGZ1bmN0aW9uIChzaWIpIHtcbiAgICAgICAgc2liLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgIH0pO1xuICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xufTtcblxuY29uc3Qgc2hvd1BhbmVsID0gKHRhYikgPT4ge1xuICAgIGxldCB0YWJJbmRleCA9IHRhYi5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFiJyk7XG4gICAgbGV0IHBhbmVscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWN0aW9uLWJ1bmRsZV9fcHJvZHVjdHMtaG9sZGVyJyk7XG5cbiAgICBwYW5lbHMuZm9yRWFjaChwYW5lbCA9PiB7XG4gICAgICAgIGNvbnN0IHBhbmVsSW5kZXggPSBwYW5lbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGFuZWwnKTtcbiAgICAgICAgaWYgKHBhbmVsSW5kZXggPT09IHRhYkluZGV4KSB7XG4gICAgICAgICAgICBwYW5lbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBhbmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuXG4vL1NXSVBFUiBGT1IgQlVORExFIENBUlQgQ0FST1VTRUxcblxudmFyIHN3aXBlciA9IG5ldyBTd2lwZXIoJy5zZWN0aW9uLWJ1bmRsZV9fY2FydC1jYXJvdXNlbCcsIHtcbiAgICBzcGFjZUJldHdlZW46IDgsXG4gICAgc2xpZGVzUGVyVmlldzogNCxcbiAgICBzbGlkZXNQZXJHcm91cDogNCxcbiAgICBicmVha3BvaW50czoge1xuICAgICAgICA3Njg6IHtcbiAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDYsXG4gICAgICAgICAgICBzbGlkZXNQZXJHcm91cDogNixcbiAgICAgICAgICAgIGRyYWdnYWJsZTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgfSxcbiAgICBuYXZpZ2F0aW9uOiB7XG4gICAgICAgIG5leHRFbDogJy5zZWN0aW9uLWJ1bmRsZV9fY2FydC1jYXJvdXNlbCAuc3dpcGVyLWJ1dHRvbi1uZXh0JyxcbiAgICAgICAgcHJldkVsOiAnLnNlY3Rpb24tYnVuZGxlX19jYXJ0LWNhcm91c2VsIC5zd2lwZXItYnV0dG9uLXByZXYnXG4gICAgfSxcbiAgICBzY3JvbGxiYXI6IHtcbiAgICAgICAgZWw6ICcuc2VjdGlvbi1idW5kbGVfX2NhcnQtY2Fyb3VzZWwgLnN3aXBlci1zY3JvbGxiYXInLFxuICAgICAgICBkcmFnZ2FibGU6IHRydWUsXG4gICAgfVxufSk7XG5cbi8vVE9HR0xFIEJVTkRMRVxuY29uc3QgYnVuZGxlQ2Fyb3VzZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVuZGxlLXdyYXAnKTtcbmNvbnN0IGJ1bmRsZVRvZ2dsZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtYnVuZGxlLXRvZ2dsZScpO1xuXG5idW5kbGVUb2dnbGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGJ1bmRsZUNhcm91c2VsLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGUtYnVuZGxlJyk7XG4gICAgaWYgKGJ1bmRsZUNhcm91c2VsLmNsYXNzTGlzdC5jb250YWlucygnaGlkZS1idW5kbGUnKSkge1xuICAgICAgICBidW5kbGVUb2dnbGVyLnRleHRDb250ZW50ID0gJ1NIT1cgQlVORExFJztcbiAgICB9IGVsc2Uge1xuICAgICAgICBidW5kbGVUb2dnbGVyLnRleHRDb250ZW50ID0gJ0hJREUgQlVORExFJztcbiAgICB9XG59KTtcblxuLy9BREQgVE8gQ0FSVCBMT0dJQ1xuY29uc3QgYnVuZGxlQXRjQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1hdGMnKTtcblxuaWYgKGJ1bmRsZUF0Y0J1dHRvbnMpIHtcbiAgICBidW5kbGVBdGNCdXR0b25zLmZvckVhY2goYXRjQnV0dG9uID0+IHtcbiAgICAgICAgYXRjQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIGxldCBvdmVybGF5QnVuZGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1bmRsZS1vdmVybGF5Jyk7XG4gICAgICAgICAgICBvdmVybGF5QnVuZGxlLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcbiAgICAgICAgICAgIGxldCBpZFNlbGVjdG9ycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1pZC1zZWxlY3RvcicpO1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgbGV0IGFkZEl0ZW1zID0gW11cbiAgICAgICAgICAgIGlkU2VsZWN0b3JzLmZvckVhY2goKGlkU2VsZWN0b3IpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgaWQgPSBpZFNlbGVjdG9yLmdldEF0dHJpYnV0ZSgnZGF0YS1pdGVtLWlkJyk7XG4gICAgICAgICAgICAgICAgbGV0IHF1YW50aXR5ID0gaWRTZWxlY3Rvci5nZXRBdHRyaWJ1dGUoJ2RhdGEtaXRlbS1xdHknKTtcbiAgICAgICAgICAgICAgICBpZihxdWFudGl0eSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkSXRlbXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcXVhbnRpdHlcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgY29uc3QgZm9ybURhdGEgPSB7XG4gICAgICAgICAgICAgICAgaXRlbXM6IGFkZEl0ZW1zXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmZXRjaCh3aW5kb3cuU2hvcGlmeS5yb3V0ZXMucm9vdCArICdjYXJ0L2FkZC5qcycsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGZvcm1EYXRhKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2Uuc3RhdHVzLCAnb2snKVxuICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmxheUJ1bmRsZS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvcjonLCBlcnJvcilcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH0pXG59XG5cbmNvbnN0IGJ1bmRsZUNoZWNrb3V0QnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1jaGVja291dC1ub3cnKTtcbmlmKGJ1bmRsZUNoZWNrb3V0QnV0dG9ucykge1xuICAgIGJ1bmRsZUNoZWNrb3V0QnV0dG9ucy5mb3JFYWNoKGJ1bmRsZUNoZWNrb3V0QnV0dG9uID0+IHtcbiAgICAgICAgYnVuZGxlQ2hlY2tvdXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZSkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgY2xlYXJDYXJ0KCk7XG4gICAgICAgIH0pXG4gICAgfSlcbn1cbmFzeW5jIGZ1bmN0aW9uIGNsZWFyQ2FydCgpIHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcmVidXktY2FydCcpLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuICAgIGZldGNoKCcvY2FydC9jbGVhci5qcycsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgfVxuICAgIH0pXG4gICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDYXJ0IGNsZWFyZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICAgIHJldHVybiBBdEMoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjbGVhciBjYXJ0Jyk7XG4gICAgICB9XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY2xlYXJpbmcgY2FydDonLCBlcnJvcik7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBBdEMoKSB7XG4gICAgbGV0IG92ZXJsYXlCdW5kbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVuZGxlLW92ZXJsYXknKTtcbiAgICAgICAgICAgIG92ZXJsYXlCdW5kbGUuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICAgICAgICAgICAgbGV0IGlkU2VsZWN0b3JzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmpzLWlkLXNlbGVjdG9yJyk7XG4gICAgICAgICAgICBsZXQgYWRkSXRlbXMgPSBbXVxuICAgICAgICAgICAgaWRTZWxlY3RvcnMuZm9yRWFjaCgoaWRTZWxlY3RvcikgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBpZCA9IGlkU2VsZWN0b3IuZ2V0QXR0cmlidXRlKCdkYXRhLWl0ZW0taWQnKTtcbiAgICAgICAgICAgICAgICBsZXQgcXVhbnRpdHkgPSBpZFNlbGVjdG9yLmdldEF0dHJpYnV0ZSgnZGF0YS1pdGVtLXF0eScpO1xuICAgICAgICAgICAgICAgIGlmKHF1YW50aXR5ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBhZGRJdGVtcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiBxdWFudGl0eVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBjb25zdCBmb3JtRGF0YSA9IHtcbiAgICAgICAgICAgICAgICBpdGVtczogYWRkSXRlbXNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZldGNoKHdpbmRvdy5TaG9waWZ5LnJvdXRlcy5yb290ICsgJ2NhcnQvYWRkLmpzJywge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZm9ybURhdGEpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5zdGF0dXMsICdvaycpXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvY2hlY2tvdXQnXG4gICAgICAgICAgICAgICAgICAgICAgICBvdmVybGF5QnVuZGxlLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yOicsIGVycm9yKVxuICAgICAgICAgICAgICAgIH0pXG59XG5hc3luYyBmdW5jdGlvbiByZWZyZXNoQ2FydCgpIHtcbiAgICBjb25zdCBjYXJ0ID0gY2FydFNhbXBsZTtcbiAgICBjb25zdCBidW5kbGVJdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWN0aW9uLWJ1bmRsZV9fY2FydC1jYXJvdXNlbC1pdGVtJyk7XG4gICAgY29uc3QgYnVuZGxlSG9sZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLWhvbGRlcicpO1xuICAgIGJ1bmRsZUhvbGRlci5pbm5lckhUTUwgPSAnJztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICAgICAgaWYoY2FydC5pdGVtc1tpXSkge1xuICAgICAgICBidW5kbGVIb2xkZXIuaW5uZXJIVE1MICs9IGBcbiAgICAgICAgPGRpdiBjbGFzcz1cInN3aXBlci1zbGlkZSBwLVsxOHB4XVwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNlY3Rpb24tYnVuZGxlX19jYXJ0LWNhcm91c2VsLWl0ZW0gZmxleC1jb2xcIj5cblxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJxdHktaG9sZGVyXCI+JHtjYXJ0Lml0ZW1zW2ldLnF1YW50aXR5ID4gMSA/IGNhcnQuaXRlbXNbaV0ucXVhbnRpdHkgOiAnJ308L2Rpdj5cbiAgICAgICAgICAgICAgICA8aW1nIGNsYXNzPVwiXCIgc3JjPVwiJHtjYXJ0Lml0ZW1zW2ldLmltYWdlfVwiPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICBgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1bmRsZUhvbGRlci5pbm5lckhUTUwgKz0gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN3aXBlci1zbGlkZVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzZWN0aW9uLWJ1bmRsZV9fY2FydC1jYXJvdXNlbC1pdGVtXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtcXVhbnRpdHlfX2J1dHRvbiBpbmNyZWFzZSAgcCBkbS1zYW5zLW5vcm1hbCBjb2xvci13aGl0ZSB0ZXh0LWNlbnRlclwiPis8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgYFxuICAgICAgICB9XG4gICAgICAgIC8vIGlmKGNhcnQuaXRlbXNbaV0gJiYgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsYXNzLScgKyBjYXJ0Lml0ZW1zW2ldLnByb2R1Y3RfaWQpKSB7XG4gICAgICAgIC8vICAgICBsZXQgc2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2xhc3MtJyArIGNhcnQuaXRlbXNbaV0ucHJvZHVjdF9pZClcbiAgICAgICAgLy8gICAgIHNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoJy5qcy1xdHktbnVtYmVyJykuaW5uZXJIVE1MID0gY2FydC5pdGVtc1tpXS5xdWFudGl0eTtcbiAgICAgICAgLy8gICAgIHNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoJy5wbHVzJykuc2V0QXR0cmlidXRlKCdkYXRhLXF1YW50aXR5JywgY2FydC5pdGVtc1tpXS5xdWFudGl0eSArIDEpO1xuICAgICAgICAvLyAgICAgc2VsZWN0b3IucXVlcnlTZWxlY3RvcignLm1pbnVzJykuc2V0QXR0cmlidXRlKCdkYXRhLXF1YW50aXR5JywgY2FydC5pdGVtc1tpXS5xdWFudGl0eSAtMSApO1xuICAgICAgICAvLyB9XG4gICAgfVxuXG4gICAgdmFyIHN3aXBlciA9IG5ldyBTd2lwZXIoJy5zZWN0aW9uLWJ1bmRsZV9fY2FydC1jYXJvdXNlbCcsIHtcbiAgICAgICAgc3BhY2VCZXR3ZWVuOiA4LFxuICAgICAgICBzbGlkZXNQZXJWaWV3OiA0LFxuICAgICAgICBzbGlkZXNQZXJHcm91cDogNCxcbiAgICAgICAgYnJlYWtwb2ludHM6IHtcbiAgICAgICAgICAgIDc2ODoge1xuICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDYsXG4gICAgICAgICAgICAgICAgc2xpZGVzUGVyR3JvdXA6IDYsXG4gICAgICAgICAgICAgICAgZHJhZ2dhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIG5hdmlnYXRpb246IHtcbiAgICAgICAgICAgIG5leHRFbDogJy5zZWN0aW9uLWJ1bmRsZV9fY2FydC1jYXJvdXNlbCAuc3dpcGVyLWJ1dHRvbi1uZXh0JyxcbiAgICAgICAgICAgIHByZXZFbDogJy5zZWN0aW9uLWJ1bmRsZV9fY2FydC1jYXJvdXNlbCAuc3dpcGVyLWJ1dHRvbi1wcmV2J1xuICAgICAgICB9LFxuICAgICAgICBzY3JvbGxiYXI6IHtcbiAgICAgICAgICAgIGVsOiAnLnNlY3Rpb24tYnVuZGxlX19jYXJ0LWNhcm91c2VsIC5zd2lwZXItc2Nyb2xsYmFyJyxcbiAgICAgICAgICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGxldCBhbGxRdHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuanMtcXR5LW51bWJlcicpO1xuICAgIGxldCBxdHkgPSAwO1xuICAgIGNhcnQuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgaWYoaXRlbS50eXBlICE9PSAnZ2lmdCcpIHtcbiAgICAgICAgICAgIHF0eSArPSBwYXJzZUludChpdGVtLnF1YW50aXR5KTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGxldCBwb2ludHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9pbnQnKTtcbiAgICBsZXQgYWxsTGluZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubGluZScpO1xuICAgIGxldCBhbGxOdW1iZXIgPSAwO1xuICAgIGZvciAobGV0IHkgPSAwOyB5IDwgYWxsUXR5Lmxlbmd0aDsgeSsrKSB7XG4gICAgICAgIGFsbE51bWJlciArPSBwYXJzZUZsb2F0KGFsbFF0eVt5XS5pbm5lckhUTUwpO1xuICAgIH1cbiAgICBwb2ludHMuZm9yRWFjaCgocG9pbnQsIGluZGV4KSA9PiB7XG4gICAgICAgIGlmKHBvaW50KSB7XG4gICAgICAgICAgICBwb2ludC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnI2FkYWRhZCdcbiAgICAgICAgfVxuICAgIH0pXG4gICAgYWxsTGluZXMuZm9yRWFjaCgoYWxsTGluZSwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYoYWxsTGluZSkge1xuICAgICAgICAgICAgYWxsTGluZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnI2FkYWRhZCdcbiAgICAgICAgfVxuICAgIH0pXG4gICAgZm9yIChsZXQgeiA9IDA7IHogPCBxdHk7IHorKykge1xuICAgICAgICBpZihwb2ludHNbel0pIHtcbiAgICAgICAgICAgIHBvaW50c1t6XS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnIzYwYzY1NSc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IGxpbWl0ZXIgPSBxdHkgKiAyIC0gMTtcbiAgICBmb3IgKGxldCBrID0gMDsgayA8IGxpbWl0ZXI7IGsrKykge1xuICAgICAgICBpZihhbGxMaW5lc1trXSkge1xuICAgICAgICAgICAgYWxsTGluZXNba10uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyM2MGM2NTUnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1yZW1vdmUnKS5mb3JFYWNoKChyZW1vdmUpID0+IHtcbiAgICAgICAgICAgIHJlbW92ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgaXRlbUlkID0gcmVtb3ZlLmdldEF0dHJpYnV0ZSgnZGF0YS12YXJpYW50LWlkJyk7XG4gICAgICAgICAgICAgICAgbGV0IHByb2R1Y3RJZCA9IHJlbW92ZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvZHVjdC1pZCcpO1xuICAgICAgICAgICAgICAgIGZldGNoKHdpbmRvdy5TaG9waWZ5LnJvdXRlcy5yb290ICsgJ2NhcnQvY2hhbmdlLmpzJywge1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogaXRlbUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IDBcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5zdGF0dXMpXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5zdGF0dXMsICdva2traycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsYXNzLScgKyBwcm9kdWN0SWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3IucXVlcnlTZWxlY3RvcignLmpzLXF0eS1udW1iZXInKS5pbm5lckhUTUwgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoJy5wbHVzJykuc2V0QXR0cmlidXRlKCdkYXRhLXF1YW50aXR5JywgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3IucXVlcnlTZWxlY3RvcignLm1pbnVzJykuc2V0QXR0cmlidXRlKCdkYXRhLXF1YW50aXR5JywgMCApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hDYXJ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yOicsIGVycm9yKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9LCAyMDAwKVxuICAgIGxldCB0b3RhbFByaWNlID0gMDtcbiAgICBsZXQgY29tcGFyZVByaWNlID0gMDtcbiAgICBsZXQgdG90YWxRdHkgPSAwO1xuXG4gICAgY2FydC5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICBpZihpdGVtLnR5cGUgIT09ICdnaWZ0Jykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbS50eXBlLCAnZ2lmdCcpXG4gICAgICAgICAgICB0b3RhbFF0eSArPSBwYXJzZUludChpdGVtLnF1YW50aXR5KTtcbiAgICAgICAgICAgIHRvdGFsUHJpY2UgKz0gaXRlbS5wcmljZSAqIGl0ZW0ucXVhbnRpdHk7XG4gICAgICAgICAgICBjb21wYXJlUHJpY2UgKz0gaXRlbS5jb21wYXJlUHJpY2UgKiBpdGVtLnF1YW50aXR5O1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zb2xlLmxvZyh0b3RhbFF0eSwgJ2R1emluYScpXG4gICAgaWYodG90YWxRdHkgPj0gNSAmJiB0b3RhbFF0eSA8IDcpIHtcbiAgICAgICAgdG90YWxQcmljZSA9IHRvdGFsUHJpY2UgKiAwLjk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd1c2FvIHUgNScpXG4gICAgfSBlbHNlIGlmKHRvdGFsUXR5ID49IDcgJiYgdG90YWxRdHkgPCAxMCkge1xuICAgICAgICBjb25zb2xlLmxvZygndXNhbyB1IDcnKVxuICAgICAgICB0b3RhbFByaWNlID0gdG90YWxQcmljZSAqIDAuNztcbiAgICB9IGVsc2UgaWYodG90YWxRdHkgPj0gMTApIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3VzYW8gdSAxMCcpXG4gICAgICAgIHRvdGFsUHJpY2UgPSB0b3RhbFByaWNlICogMC42O1xuICAgIH1cbiAgICAvLyBpZih0b3RhbFF0eSA+PSA3KSB7XG4gICAgLy8gICAgIHRvdGFsUHJpY2UgPSB0b3RhbFByaWNlICogMC43O1xuICAgIC8vIH1cbiAgICAvLyBpZih0b3RhbFF0eSA+IDEwKSB7XG4gICAgLy8gICAgIHRvdGFsUHJpY2UgPSB0b3RhbFByaWNlICogMC42O1xuICAgIC8vIH1cbiAgICBhc3luYyBmdW5jdGlvbiBnZXRDYXJ0KCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmZXRjaChcIi9jYXJ0Lmpzb25cIik7XG4gICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGdldCByZXF1ZXN0LCBTaG9waWZ5IHJldHVybmVkICR7cmVzdWx0LnN0YXR1c30gJHtyZXN1bHQuc3RhdHVzVGV4dH1gKTtcbiAgICB9XG4gICAgbGV0IGNhcnRTeW1ib2wgPSBhd2FpdCBnZXRDYXJ0KCk7XG4gICAgbGV0IGN1cnJlbmN5U3ltYm9sID0gY2FydFN5bWJvbC5jdXJyZW5jeTtcbiAgICBpZihjdXJyZW5jeVN5bWJvbCA9PSAnVVNEJykge1xuICAgICAgICBjdXJyZW5jeVN5bWJvbCA9ICckJ1xuICAgIH1cbiAgICBpZihjdXJyZW5jeVN5bWJvbCA9PSAnRVVSJykge1xuICAgICAgICBjdXJyZW5jeVN5bWJvbCA9ICfigqwnXG4gICAgfVxuICAgIGlmKGN1cnJlbmN5U3ltYm9sID09ICdHQlAnKSB7XG4gICAgICAgIGN1cnJlbmN5U3ltYm9sID0gJ8KjJ1xuICAgIH1cbiAgICBjb25zdCBmb3JtYXR0ZWRQcmljZSA9IGN1cnJlbmN5U3ltYm9sICsgKHRvdGFsUHJpY2UvMTAwKS50b0ZpeGVkKDIpXG4gICAgY29uc3QgZm9ybWF0dGVkUHJpY2VDb21wYXJlID0gY3VycmVuY3lTeW1ib2wgKyAoY29tcGFyZVByaWNlLzEwMCkudG9GaXhlZCgyKVxuICAgIGNvbnN0IHRvdGFsUHJpY2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tYnVuZGxlX19zdGlja3ktcHJpY2UnKTtcbiAgICBjb25zdCB0b3RhbFByaWNlRWxlbWVudENvbXBhcmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi1idW5kbGVfX3N0aWNreS1wcmljZS1jb21wYXJlJyk7XG4gICAgdG90YWxQcmljZUVsZW1lbnQudGV4dENvbnRlbnQgPSBmb3JtYXR0ZWRQcmljZTtcbiAgICBpZihjb21wYXJlUHJpY2UgPiAwKSB7XG4gICAgICAgIHRvdGFsUHJpY2VFbGVtZW50Q29tcGFyZS50ZXh0Q29udGVudCA9IGZvcm1hdHRlZFByaWNlQ29tcGFyZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRvdGFsUHJpY2VFbGVtZW50Q29tcGFyZS50ZXh0Q29udGVudCA9ICcnO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCdSZWZyZXNoZWQgY2FydCcpO1xufVxuY29uc3QgcGx1c2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsdXMnKVxuY29uc3QgbWludXNlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5taW51cycpXG5cbnBsdXNlcy5mb3JFYWNoKChwbHVzZSkgPT4ge1xuICAgIHBsdXNlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBsZXQgcGFyZW50RWxlbWVudCA9IHBsdXNlLnBhcmVudE5vZGU7XG4gICAgICAgIHBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlLWl0ZW0nKVxuICAgICAgICBsZXQgcGFzdCA9IHBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1pbnVzJylcbiAgICAgICAgbGV0IG5vdyA9IHBhcmVudEVsZW1lbnRcbiAgICAgICAgbGV0IGZ1dHVyZSA9IHBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsdXMnKVxuICAgICAgICBsZXQgbm93TnVtYmVyID0gbm93LmdldEF0dHJpYnV0ZSgnZGF0YS1pdGVtLXF0eScpXG4gICAgICAgIGxldCBmdXR1cmVOdW1iZXIgPSBmdXR1cmUuZ2V0QXR0cmlidXRlKCdkYXRhLXF1YW50aXR5JylcbiAgICAgICAgbGV0IHBhc3ROdW1iZXIgPSBwYXN0LmdldEF0dHJpYnV0ZSgnZGF0YS1xdWFudGl0eScpXG4gICAgICAgIG5vd051bWJlciA9IHBhcnNlSW50KG5vd051bWJlcikgKyAxXG4gICAgICAgIGZ1dHVyZU51bWJlciA9IHBhcnNlSW50KGZ1dHVyZU51bWJlcikgKyAxXG4gICAgICAgIHBhc3ROdW1iZXIgPSBwYXJzZUludChwYXN0TnVtYmVyKSArIDFcbiAgICAgICAgbm93LnNldEF0dHJpYnV0ZSgnZGF0YS1pdGVtLXF0eScsIG5vd051bWJlcilcbiAgICAgICAgbm93LnF1ZXJ5U2VsZWN0b3IoJy5qcy1xdHktbnVtYmVyJykuaW5uZXJIVE1MID0gbm93TnVtYmVyXG4gICAgICAgIHBhc3Quc2V0QXR0cmlidXRlKCdkYXRhLXF1YW50aXR5JywgcGFzdE51bWJlcilcbiAgICAgICAgZnV0dXJlLnNldEF0dHJpYnV0ZSgnZGF0YS1xdWFudGl0eScsIGZ1dHVyZU51bWJlcilcbiAgICAgICAgbGV0IGltYWdlID0gcGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaW1hZ2UnKVxuICAgICAgICBsZXQgaWQgPSBwYXJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1pdGVtLWlkJylcbiAgICAgICAgZ2VuZXJhdGVDYXJ0KCk7XG4gICAgICAgIHJlZnJlc2hDYXJ0KCk7XG4gICAgfSlcbn0pXG5cbm1pbnVzZXMuZm9yRWFjaCgobWludXMpID0+IHtcbiAgICBtaW51cy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgbGV0IHBhcmVudEVsZW1lbnQgPSBtaW51cy5wYXJlbnROb2RlO1xuICAgICAgICBsZXQgcGFzdCA9IHBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1pbnVzJylcbiAgICAgICAgbGV0IG5vdyA9IHBhcmVudEVsZW1lbnRcbiAgICAgICAgbGV0IGZ1dHVyZSA9IHBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsdXMnKVxuICAgICAgICBsZXQgbm93TnVtYmVyID0gbm93LmdldEF0dHJpYnV0ZSgnZGF0YS1pdGVtLXF0eScpXG4gICAgICAgIGxldCBmdXR1cmVOdW1iZXIgPSBmdXR1cmUuZ2V0QXR0cmlidXRlKCdkYXRhLXF1YW50aXR5JylcbiAgICAgICAgbGV0IHBhc3ROdW1iZXIgPSBwYXN0LmdldEF0dHJpYnV0ZSgnZGF0YS1xdWFudGl0eScpXG4gICAgICAgIGlmKG5vd051bWJlciA+IDApIHtcbiAgICAgICAgICAgIG5vd051bWJlciA9IHBhcnNlSW50KG5vd051bWJlcikgLSAxXG4gICAgICAgIH1cbiAgICAgICAgaWYoZnV0dXJlTnVtYmVyID4gMCkge1xuICAgICAgICAgICAgZnV0dXJlTnVtYmVyID0gcGFyc2VJbnQoZnV0dXJlTnVtYmVyKSAtIDFcbiAgICAgICAgfVxuICAgICAgICBpZihmdXR1cmVOdW1iZXIgPiAwKSB7XG4gICAgICAgICAgICBwYXN0TnVtYmVyXG4gICAgICAgIH1cbiAgICAgICAgaWYobm93TnVtYmVyIDwgMSkge1xuICAgICAgICAgICAgcGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUtaXRlbScpXG4gICAgICAgIH1cbiAgICAgICAgbm93LnNldEF0dHJpYnV0ZSgnZGF0YS1pdGVtLXF0eScsIG5vd051bWJlcilcbiAgICAgICAgbm93LnF1ZXJ5U2VsZWN0b3IoJy5qcy1xdHktbnVtYmVyJykuaW5uZXJIVE1MID0gbm93TnVtYmVyXG4gICAgICAgIHBhc3Quc2V0QXR0cmlidXRlKCdkYXRhLXF1YW50aXR5JywgcGFzdE51bWJlcilcbiAgICAgICAgZnV0dXJlLnNldEF0dHJpYnV0ZSgnZGF0YS1xdWFudGl0eScsIGZ1dHVyZU51bWJlcilcbiAgICAgICAgZ2VuZXJhdGVDYXJ0KCk7XG4gICAgICAgIHJlZnJlc2hDYXJ0KCk7XG4gICAgICAgIC8vIHVwZGF0ZUNhcnQoaXRlbUlkLCBxdWFudGl0eSk7XG4gICAgICAgIC8vIG1pbnVzLnNldEF0dHJpYnV0ZSgnZGF0YS1xdWFudGl0eScsIG5ld1ZhbHVlKVxuICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgLy8gICAgIHJlZnJlc2hDYXJ0KCk7XG4gICAgICAgIC8vIH0sIDEwMDApXG4gICAgfSlcbn0pXG5cbmxldCBpbmZvVHJpZ2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pbmZvLWljb24tdHJpZ2dlcicpO1xubGV0IGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsb3NlJyk7XG5pbmZvVHJpZ2Vycy5mb3JFYWNoKChpbmZvVHJpZ2VyKSA9PiB7XG4gICAgaW5mb1RyaWdlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIGxldCBpbmZvSW1hZ2UgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaW1hZ2UnKTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmluZm8taW1hZ2UnKS5zcmMgPSBpbmZvSW1hZ2U7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LW92ZXJsYXknKS5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKS5jbGFzc0xpc3QuYWRkKCduby1zY3JvbGwnKVxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJykuY2xhc3NMaXN0LmFkZCgnbm8tc2Nyb2xsJylcbiAgICB9KVxufSlcbmNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZHVjdC1vdmVybGF5JykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKS5jbGFzc0xpc3QucmVtb3ZlKCduby1zY3JvbGwnKVxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5jbGFzc0xpc3QucmVtb3ZlKCduby1zY3JvbGwnKVxufSlcblxubGV0IGluZm9QbGF5VHJpZ2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy12aWRlby10cmlnJyk7XG5sZXQgY2xvc2VQbGF5QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsb3NlLXBsYXknKTtcbmluZm9QbGF5VHJpZ2Vycy5mb3JFYWNoKChpbmZvVHJpZ2VyKSA9PiB7XG4gICAgaW5mb1RyaWdlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIGxldCBpbmZvVmlkZW8gPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmlkZW8nKTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmluZm8tdmlkZW8nKS5zcmMgPSBpbmZvVmlkZW87XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LXBsYXktb3ZlcmxheScpLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLmNsYXNzTGlzdC5hZGQoJ25vLXNjcm9sbCcpXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5jbGFzc0xpc3QuYWRkKCduby1zY3JvbGwnKVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbmZvLXZpZGVvJykucGxheSgpO1xuICAgICAgICB9LCAzMDApXG4gICAgfSlcbn0pXG5jbG9zZVBsYXlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LXBsYXktb3ZlcmxheScpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JykuY2xhc3NMaXN0LnJlbW92ZSgnbm8tc2Nyb2xsJylcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJykuY2xhc3NMaXN0LnJlbW92ZSgnbm8tc2Nyb2xsJylcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW5mby12aWRlbycpLnBhdXNlKCk7XG59KVxuXG5sZXQgb3ZlcmxheUNscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LXBsYXktb3ZlcmxheScpO1xub3ZlcmxheUNscy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwcm9kdWN0LXBsYXktb3ZlcmxheScpKSB7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LXBsYXktb3ZlcmxheScpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLmNsYXNzTGlzdC5yZW1vdmUoJ25vLXNjcm9sbCcpXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5jbGFzc0xpc3QucmVtb3ZlKCduby1zY3JvbGwnKVxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW5mby12aWRlbycpLnBhdXNlKCk7XG4gICAgfVxufSlcblxubGV0IG92ZXJsYXlDbHNJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LW92ZXJsYXknKTtcbm92ZXJsYXlDbHNJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2R1Y3Qtb3ZlcmxheScpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JykuY2xhc3NMaXN0LnJlbW92ZSgnbm8tc2Nyb2xsJylcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJykuY2xhc3NMaXN0LnJlbW92ZSgnbm8tc2Nyb2xsJylcbn0pXG5cbnJlZnJlc2hDYXJ0KCk7XG5cbmNvbnN0IGRpc3RhbmNlVHJhY2tlciA9ICQoJy5idW5kbGUtd3JhcCcpLm9mZnNldCgpLnRvcFxuJCh3aW5kb3cpLnNjcm9sbChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgdG9wX29mX2VsZW1lbnQgPSAkKCcjc2hvcGlmeS1zZWN0aW9uLWZvb3RlcicpLm9mZnNldCgpLnRvcFxuICAgIGNvbnN0IGJvdHRvbV9vZl9lbGVtZW50ID0gJCgnI3Nob3BpZnktc2VjdGlvbi1mb290ZXInKS5vZmZzZXQoKS50b3AgKyAkKCcjc2hvcGlmeS1zZWN0aW9uLWZvb3RlcicpLm91dGVySGVpZ2h0KClcbiAgICBjb25zdCBib3R0b21fb2Zfc2NyZWVuID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpICsgJCh3aW5kb3cpLmlubmVySGVpZ2h0KClcbiAgICBjb25zdCB0b3Bfb2Zfc2NyZWVuID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpXG4gICAgaWYgKCEoYm90dG9tX29mX3NjcmVlbiA+IHRvcF9vZl9lbGVtZW50KSAmJiAodG9wX29mX3NjcmVlbiA8IGJvdHRvbV9vZl9lbGVtZW50KSAmJiAkKHRoaXMpLnNjcm9sbFRvcCgpID49IGRpc3RhbmNlVHJhY2tlcikge1xuICAgICAgJCgnLnNlY3Rpb24tYnVuZGxlX190cmFja2VyJykuYWRkQ2xhc3MoJ3RyYWNrZXItZml4ZWQnKVxuICAgIH0gZWxzZSB7XG4gICAgICAkKCcuc2VjdGlvbi1idW5kbGVfX3RyYWNrZXInKS5yZW1vdmVDbGFzcygndHJhY2tlci1maXhlZCcpXG4gICAgfVxufSlcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9kdWN0JykuZm9yRWFjaChwcm9kdWN0RWxlbWVudCA9PiB7XG4gICAgICBjb25zdCBwcm9kdWN0SWQgPSBwcm9kdWN0RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvZHVjdC1pZCcpO1xuICAgICAgY29uc3Qgc2VsZWN0b3JzID0gcHJvZHVjdEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnZhcmlhbnQtc2VsZWN0b3JzIHNlbGVjdCcpO1xuICAgICAgY29uc3QgYWRkVG9DYXJ0QnV0dG9uID0gcHJvZHVjdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmpzLWlkLXNlbGVjdG9yJyk7XG4gICAgICBjb25zdCBwcmljZSA9IHByb2R1Y3RFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1yZWd1bGFyLXByaWNlJyk7XG4gICAgICBjb25zdCBjb21wYXJlUHJpY2UgPSBwcm9kdWN0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuanMtY29tcGFyZS1wcmljZScpO1xuICAgICAgY29uc3QgaWRTZWxlY3RvciA9IHByb2R1Y3RFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1pZC1zZWxlY3RvcicpO1xuXG4gICAgICBmdW5jdGlvbiBnZXRWYXJpYW50SWQoc2VsZWN0ZWRPcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3RWYXJpYW50cyA9IHdpbmRvdy5wcm9kdWN0VmFyaWFudHNbcHJvZHVjdElkXTtcbiAgICAgICAgY29uc3QgdmFyaWFudCA9IHByb2R1Y3RWYXJpYW50cy5maW5kKHZhcmlhbnQgPT5cbiAgICAgICAgICB2YXJpYW50Lm9wdGlvbnMuZXZlcnkoKG9wdGlvbiwgaW5kZXgpID0+IG9wdGlvbiA9PT0gc2VsZWN0ZWRPcHRpb25zW2luZGV4XSlcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHZhcmlhbnQgPyB2YXJpYW50LmlkIDogJyc7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBnZXRWYXJpYW50UHJpY2Uoc2VsZWN0ZWRPcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3RWYXJpYW50cyA9IHdpbmRvdy5wcm9kdWN0VmFyaWFudHNbcHJvZHVjdElkXTtcbiAgICAgICAgY29uc3QgdmFyaWFudCA9IHByb2R1Y3RWYXJpYW50cy5maW5kKHZhcmlhbnQgPT5cbiAgICAgICAgICB2YXJpYW50Lm9wdGlvbnMuZXZlcnkoKG9wdGlvbiwgaW5kZXgpID0+IG9wdGlvbiA9PT0gc2VsZWN0ZWRPcHRpb25zW2luZGV4XSlcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHZhcmlhbnQgPyB2YXJpYW50LnByaWNlTW9uZXkgOiAnJztcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGdldFZhcmlhbnRQcmljZVJhdyhzZWxlY3RlZE9wdGlvbnMpIHtcbiAgICAgICAgY29uc3QgcHJvZHVjdFZhcmlhbnRzID0gd2luZG93LnByb2R1Y3RWYXJpYW50c1twcm9kdWN0SWRdO1xuICAgICAgICBjb25zdCB2YXJpYW50ID0gcHJvZHVjdFZhcmlhbnRzLmZpbmQodmFyaWFudCA9PlxuICAgICAgICAgIHZhcmlhbnQub3B0aW9ucy5ldmVyeSgob3B0aW9uLCBpbmRleCkgPT4gb3B0aW9uID09PSBzZWxlY3RlZE9wdGlvbnNbaW5kZXhdKVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gdmFyaWFudCA/IHZhcmlhbnQucHJpY2VSYXcgOiAnJztcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGdldFZhcmlhbnRDb21wYXJlUHJpY2Uoc2VsZWN0ZWRPcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3RWYXJpYW50cyA9IHdpbmRvdy5wcm9kdWN0VmFyaWFudHNbcHJvZHVjdElkXTtcbiAgICAgICAgY29uc3QgdmFyaWFudCA9IHByb2R1Y3RWYXJpYW50cy5maW5kKHZhcmlhbnQgPT5cbiAgICAgICAgICB2YXJpYW50Lm9wdGlvbnMuZXZlcnkoKG9wdGlvbiwgaW5kZXgpID0+IG9wdGlvbiA9PT0gc2VsZWN0ZWRPcHRpb25zW2luZGV4XSlcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHZhcmlhbnQgPyB2YXJpYW50LmNvbXBhcmVwcmljZU1vbmV5IDogJyc7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBnZXRWYXJpYW50Q29tcGFyZVByaWNlUmF3KHNlbGVjdGVkT3B0aW9ucykge1xuICAgICAgICBjb25zdCBwcm9kdWN0VmFyaWFudHMgPSB3aW5kb3cucHJvZHVjdFZhcmlhbnRzW3Byb2R1Y3RJZF07XG4gICAgICAgIGNvbnN0IHZhcmlhbnQgPSBwcm9kdWN0VmFyaWFudHMuZmluZCh2YXJpYW50ID0+XG4gICAgICAgICAgdmFyaWFudC5vcHRpb25zLmV2ZXJ5KChvcHRpb24sIGluZGV4KSA9PiBvcHRpb24gPT09IHNlbGVjdGVkT3B0aW9uc1tpbmRleF0pXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiB2YXJpYW50ID8gdmFyaWFudC5jb21wYXJlcHJpY2VSYXcgOiAnJztcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gdXBkYXRlQWRkVG9DYXJ0QnV0dG9uKCkge1xuICAgICAgICBsZXQgc2VsZWN0ZWRPcHRpb25zID0gW107XG4gICAgICAgIHNlbGVjdG9ycy5mb3JFYWNoKHNlbGVjdG9yID0+IHtcbiAgICAgICAgICBzZWxlY3RlZE9wdGlvbnMucHVzaChzZWxlY3Rvci52YWx1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHZhcmlhbnRJZCA9IGdldFZhcmlhbnRJZChzZWxlY3RlZE9wdGlvbnMpO1xuICAgICAgICBjb25zdCB2YXJpYW50UHJpY2UgPSBnZXRWYXJpYW50UHJpY2Uoc2VsZWN0ZWRPcHRpb25zKTtcbiAgICAgICAgY29uc3QgdmFyaWFudENvbXBhcmVQcmljZSA9IGdldFZhcmlhbnRDb21wYXJlUHJpY2Uoc2VsZWN0ZWRPcHRpb25zKTtcbiAgICAgICAgY29uc3QgdmFyaWFudFByaWNlUmF3ID0gZ2V0VmFyaWFudFByaWNlUmF3KHNlbGVjdGVkT3B0aW9ucyk7XG4gICAgICAgIGNvbnN0IHZhcmlhbnRDb21wYXJlUHJpY2VSYXcgPSBnZXRWYXJpYW50Q29tcGFyZVByaWNlUmF3KHNlbGVjdGVkT3B0aW9ucyk7XG5cbiAgICAgICAgaWYodmFyaWFudFByaWNlKSB7XG4gICAgICAgICAgICBwcmljZS50ZXh0Q29udGVudCA9IHZhcmlhbnRQcmljZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHZhcmlhbnRDb21wYXJlUHJpY2UpIHtcbiAgICAgICAgICAgIGNvbXBhcmVQcmljZS50ZXh0Q29udGVudCA9IHZhcmlhbnRDb21wYXJlUHJpY2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZih2YXJpYW50SWQpIHtcbiAgICAgICAgICAgIGFkZFRvQ2FydEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtaXRlbS1pZCcsIHZhcmlhbnRJZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYodmFyaWFudFByaWNlUmF3KSB7XG4gICAgICAgICAgICBpZFNlbGVjdG9yLnNldEF0dHJpYnV0ZSgnZGF0YS1pdGVtLXByaWNlJywgdmFyaWFudFByaWNlUmF3KTtcbiAgICAgICAgfVxuICAgICAgICBpZih2YXJpYW50Q29tcGFyZVByaWNlUmF3KSB7XG4gICAgICAgICAgICBpZFNlbGVjdG9yLnNldEF0dHJpYnV0ZSgnZGF0YS1pdGVtLWNvbXBhcmUtcHJpY2UnLCB2YXJpYW50Q29tcGFyZVByaWNlUmF3KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBzZWxlY3RvcnMuZm9yRWFjaChzZWxlY3RvciA9PiB7XG4gICAgICAgIHNlbGVjdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHVwZGF0ZUFkZFRvQ2FydEJ1dHRvbik7XG4gICAgICB9KTtcblxuICAgICAgdXBkYXRlQWRkVG9DYXJ0QnV0dG9uKCk7XG4gICAgfSk7XG4gIH0pO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/modules/bundle/bundle-atc.js\n");

/***/ }),

/***/ "./src/scripts/entries/section/bundle-atc.js":
/*!***************************************************!*\
  !*** ./src/scripts/entries/section/bundle-atc.js ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var lib_components__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lib/components */ \"./src/scripts/lib/components.js\");\n/* harmony import */ var modules_bundle_bundle_atc_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! modules/bundle/bundle-atc.js */ \"./src/modules/bundle/bundle-atc.js\");\n\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  (0,lib_components__WEBPACK_IMPORTED_MODULE_0__.initComponent)(modules_bundle_bundle_atc_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"], 'BundleAtc');\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2NyaXB0cy9lbnRyaWVzL3NlY3Rpb24vYnVuZGxlLWF0Yy5qcyIsIm1hcHBpbmdzIjoiOzs7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2hvcGlmeS1iYXNlLTIuMC8uL3NyYy9zY3JpcHRzL2VudHJpZXMvc2VjdGlvbi9idW5kbGUtYXRjLmpzP2FmZTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5pdENvbXBvbmVudCB9IGZyb20gJ2xpYi9jb21wb25lbnRzJ1xuaW1wb3J0IEJ1bmRsZUF0YyBmcm9tICdtb2R1bGVzL2J1bmRsZS9idW5kbGUtYXRjLmpzJ1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICBpbml0Q29tcG9uZW50KEJ1bmRsZUF0YywgJ0J1bmRsZUF0YycpXG59KVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/scripts/entries/section/bundle-atc.js\n");

/***/ }),

/***/ "./src/modules/bundle/bundle.css":
/*!***************************************!*\
  !*** ./src/modules/bundle/bundle.css ***!
  \***************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbW9kdWxlcy9idW5kbGUvYnVuZGxlLmNzcyIsIm1hcHBpbmdzIjoiO0FBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zaG9waWZ5LWJhc2UtMi4wLy4vc3JjL21vZHVsZXMvYnVuZGxlL2J1bmRsZS5jc3M/MGM0YSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBleHRyYWN0ZWQgYnkgbWluaS1jc3MtZXh0cmFjdC1wbHVnaW5cbmV4cG9ydCB7fTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/modules/bundle/bundle.css\n");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ var __webpack_exec__ = function(moduleId) { return __webpack_require__(__webpack_require__.s = moduleId); }
/******/ __webpack_require__.O(0, ["commons"], function() { return __webpack_exec__("./src/scripts/entries/section/bundle-atc.js"); });
/******/ var __webpack_exports__ = __webpack_require__.O();
/******/ }
]);