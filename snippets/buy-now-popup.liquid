{% assign first_upsell_product = all_products[upsell_product_one] %}
{% assign second_upsell_product = all_products[upsell_product_two] %}

<aside class="buy-now-popup fixed inset-0 bottom-0 left-0 right-0 top-0 z-[1000] bg-black bg-opacity-60 close-buy-now-popup">
    <div class="buy-now-popup__wrapper absolute left-[50%] top-[50%] translate-x-[-50%] translate-y-[-50%] h-[70vh] max-h-[860px] w-[80vw] max-w-[1280px] py-[70px] rounded-xl bg-[#fff]">
        <svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6948" width="32" height="32" class="close-buy-now-popup absolute right-[16px] top-[16px] z-[2] h-[25px] w-[25px] cursor-pointer fill-[#999]">
            <path d="M557.311759 513.248864l265.280473-263.904314c12.54369-12.480043 12.607338-32.704421 0.127295-45.248112-12.512727-12.576374-32.704421-12.607338-45.248112-0.127295L512.127295 467.904421 249.088241 204.063755c-12.447359-12.480043-32.704421-12.54369-45.248112-0.063647-12.512727 12.480043-12.54369 32.735385-0.063647 45.280796l262.975407 263.775299-265.151458 263.744335c-12.54369 12.480043-12.607338 32.704421-0.127295 45.248112 6.239161 6.271845 14.463432 9.440452 22.687703 9.440452 8.160624 0 16.319527-3.103239 22.560409-9.311437l265.216826-263.807983 265.440452 266.240344c6.239161 6.271845 14.432469 9.407768 22.65674 9.407768 8.191587 0 16.352211-3.135923 22.591372-9.34412 12.512727-12.480043 12.54369-32.704421 0.063647-45.248112L557.311759 513.248864z" p-id="6949"></path>
        </svg>
        <div class="buy-now-popup__product-body flex h-full px-[70px] overflow-y-auto">
            <figure class="max-h-[432px] h-full w-[47%] mr-[5%] relative">
                {% if badge_text %}
                  <div class="absolute left-[10px] top-[10px]">
                    <div class="discount_message relative flex bg-[#60c655] rounded-tl-[20px] md:text-[18px] text-[14px] color-white p-[6px] font-bold pr-[10px]">
                      <div>{{ badge_text }}</div>
                      <div class="absolute right-[-25px] md:right-[-40px] md:w-[60px] w-[40px] md:top-[-15px] top-[-8px]"><img width="100" height="auto" src="https://cdn.shopify.com/s/files/1/0071/1727/5191/files/lightning_bolt.png?v=1730972558"></div>
                    </div>
                  </div>
                {% endif %}
                <img src="{{ product_image | img_url: 'master' }}" alt="{{product_image.alt}}" height="432" width="432" class="h-full w-full object-cover js-variant-image"/>
            </figure>
            <div class="buy-now-popup__content flex-1">
                <a href="{{ product.url }}" class="text-[21px] pb-[6px] border-b border-solid border-[#e5e5e5] leading-[1.2] font-bold">{{ title }}</a>
                <div class="flex items-center mt-[12px]">
                    <span class="mr-[8px] text-[21px] text-[#60c655] font-bold js-variant-price">{{ price | money }}</span> <span class="crossed text-[#999] js-variant-compare-price">{{ compare_at_price | money }}</span>
                </div>
                {% if description != blank %}
                    <div class="buy-now-popup__description pb-[24px] overflow-hidden">
                        <div class="buy-now-popup__description-inner h-[100px] with-gradient overflow-hidden">
                            <div>{{ description }}</div>
                        </div>
                        <p class="buy-now-popup__expand-desc text-black text-[16px] pt-[14px] pointer flex items-center gap-[6px] color-[#60c655] color-titan-green">
                           <span> Learn More</span>
                            <svg class="text-black w-[16px] h-[16px]" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5772" width="32" height="32">
                                <path d="M225.408 368.384L496 640.641l270.592-272.257-48.64-49.024L496 542.592 274.176 319.36l-48.768 49.024z m0 0z" fill="#60c655" p-id="5773"></path>
                            </svg>
                        </p>
                    </div>
                {% endif %}
                {% if product.variants.size > 1 %}
                  <div class="variant-selectors text-center myb-[5px] mt-[10px] flex gap-[20px] mb-[20px]">
                    {% for option in product.options_with_values %}
                      {% if option.name != 'Title' or option.values[0] != 'Default Title' %}
                        <select class="variant-selector h-[46px] bg-transparent text-[16px] font-semibold rounded-[20px] leading-[46px] border border-solid border-[1px] border-[#000] min-w-[120px] p-[10px]" data-option-index="{{ forloop.index }}">
                          {% comment %} <option value="" disabled selected>Select {{ option.name }}</option> {% endcomment %}
                          {% for value in option.values %}
                            <option value="{{ value }}">{{ value }}</option>
                          {% endfor %}
                        </select>
                      {% endif %}
                    {% endfor %}
                  </div>
                {% endif %}
                <div class="buy-now-popup__quantity">
                    <h4 class="text-[16px] font-semibold">Quantity</h4>
                    <div class="buy-now-popup__quantity mt-[8px] mb-[24px]">
                        <quantity-input class="quantity cart-quantity">
                            <button class="quantity__button" name="minus" type="button">
                              {% render 'icon-minus' %}
                            </button>
                            <input
                              class="quantity__input"
                              type="number"
                              value="1"
                              min="1"
                            >
                            <button class="quantity__button" name="plus" type="button">
                              {% render 'icon-plus' %}
                            </button>
                          </quantity-input>
                    </div>
                </div>

                {% if upsell_product_one or upsell_product_two %}
                    <div class="buy-now-popup__upsell">
                      <h4 class="text-[16px] font-semibold">You May Also Like:</h4>
                      <div class="mt-[10px]">
                        {% if upsell_product_one %}
                          <div class="mb-4 last:mb-0">
                            <div data-product-id="{{first_upsell_product.selected_or_first_available_variant.id}}"
                                class="js-upsell-selector buy-now-popup__upsell-box relative flex items-center py-[20px] pr-[16px] pl-[50px] border-2 border-[#ddd] cursor-pointer mb-[2px] rounded-[6px] box-border">
                              <label class="buy-now-popup__checkbox">
                                <input type="checkbox" />
                                <span class="custom-checkbox"></span>
                              </label>
                              <figure class="relative mr-[16px]">
                                <img src="{{ first_upsell_product.featured_image | img_url: 'master' }}" alt="{{first_upsell_product.title}}" height="60" width="60" class="h-[60px] w-[60px] object-contain"/>
                              </figure>
                              <div class="w-full">
                                <h4 class="mt-[4px] text-[16px] font-medium text-[#000] mb-[6px] leading-[1]">{{ first_upsell_product.title }}</h4>
                                <div class="flex w-full flex-wrap items-center justify-between">
                                  <div class="flex items-center flex-wrap">
                                    <div class="font-semibold mr-[6px] text-[#000] leading-[1]">{{ first_upsell_product.price | money }}</div>
                                    {% if first_upsell_product.compare_at_price != blank %}
                                        <div class="text-[14px] font-semibold text-[#777777] line-through">{{ first_upsell_product.compare_at_price | money }}</div>
                                    {% endif %}
                                    {% if first_upsell_product.compare_at_price > first_upsell_product.price  %}
                                      <div class="ml-1 flex-none text-[10px] font-medium titan-red">
                                        Save {{ first_upsell_product.compare_at_price | minus: first_upsell_product.price | money }}
                                      </div>
                                    {% endif %}
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        {% endif %}
                        {% if upsell_product_two %}
                          <div class="mb-4 last:mb-0">
                            <div data-product-id="{{second_upsell_product.selected_or_first_available_variant.id}}"
                                class="js-upsell-selector buy-now-popup__upsell-box relative flex items-center py-[20px] pr-[16px] pl-[50px] border-2 border-[#ddd] cursor-pointer rounded-[6px] box-border">
                              <label class="buy-now-popup__checkbox">
                                <input type="checkbox" />
                                <span class="custom-checkbox"></span>
                              </label>
                              <figure class="relative mr-[16px]">
                                <img src="{{ second_upsell_product.featured_image | img_url: 'master' }}" alt="{{second_upsell_product.title}}" height="60" width="60" class="h-[60px] w-[60px] object-contain"/>
                              </figure>
                              <div class="w-full">
                                <h4 class="mt-[4px] text-[16px] font-medium text-[#000] mb-[6px] leading-[1]">{{ second_upsell_product.title }}</h4>
                                <div class="flex w-full flex-wrap items-center justify-between">
                                  <div class="flex items-center flex-wrap">
                                    <div class="font-semibold mr-[6px] text-[#000] leading-[1]">{{ second_upsell_product.price | money }}</div>
                                    {% if second_upsell_product.compare_at_price != blank %}
                                        <div class="text-[14px] font-semibold text-[#777777] line-through">{{ second_upsell_product.compare_at_price | money }}</div>
                                    {% endif %}
                                    {% if second_upsell_product.compare_at_price > second_upsell_product.price %}
                                      <div class="ml-1 flex-none text-[10px] font-medium titan-red">
                                        Save {{ second_upsell_product.compare_at_price | minus: second_upsell_product.price | money }}
                                      </div>
                                    {% endif %}
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        {% endif %}
                      </div>
                    </div>
                {% endif %}
            </div>
        </div>
        <div class="buy-now-popup__footer absolute bg-white bottom-0 left-0 z-[1] flex items-center rounded-b-[20px] justify-end w-full p-[13px_72px] shadow-[0_-4px_8px_rgba(0,_0,_0,_0.08)]">
            <div class="buy-now-popup__price mr-[20px] text-right flex items-center">
                <span class="mr-[8px] text-[21px] text-[#60c655] font-bold js-variant-price-2">{{ price | money }}</span>
                <span class="text-[#999] font-medium text-[16px] crossed js-variant-compare-price-2">{{ compare_at_price | money }}</span>
            </div>
            <div class="flex items-center justify-end gap-[10px]">
                <button data-product-id="{{ product_id}}" data-quantity="{{ quantity }}"
                    class="js-atc buy-now-popup__atc min-w-[200px] h-[46px] bg-transparent text-[16px] font-semibold rounded-[20px] leading-[46px] border border-solid border-[1px] border-[#000]"
                >
                    Add To Cart
                </button>
                <button data-product-id="{{ product_id}}"
                    class="js-checkout js-atc buy-now-popup__atc min-w-[200px] h-[46px] bg-[#60c655]  text-[16px] text-white font-semibold rounded-[20px] leading-[46px]">
                    Buy Now
                </button>
            </div>
        </div>
    </div>
</aside>
